<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yzl.mapper.YzlEpcTaskProgressMapper" >

    <resultMap id="BaseResultMap" type="com.yzl.pojo.YzlEpcTaskProgress" >
        <id column="id" property="id" jdbcType="BIGINT" />
        <result column="taskProgress" property="taskprogress" jdbcType="REAL" />
        <result column="createTime" property="createtime" jdbcType="TIMESTAMP" />
        <result column="GCLB" property="gclb" jdbcType="VARCHAR" />
        <result column="ZLLB" property="zllb" jdbcType="VARCHAR" />
        <result column="cityCode" property="citycode" jdbcType="VARCHAR" />
        <result column="countyCode" property="countycode" jdbcType="VARCHAR" />
        <result column="creator" property="creator" jdbcType="VARCHAR" />
        <result column="modifier" property="modifier" jdbcType="VARCHAR" />
        <result column="updateTime" property="updatetime" jdbcType="TIMESTAMP" />
        <result column="sendBack" property="sendback" jdbcType="INTEGER" />
        <result column="ZYND" property="zynd" jdbcType="VARCHAR" />
        <result column="JHND" property="jhnd" jdbcType="VARCHAR" />
        <result column="filesUrl" property="filesUrl" jdbcType="VARCHAR" />
        <result column="stat" property="stat" jdbcType="VARCHAR" />
    </resultMap>

    <sql id="Example_Where_Clause" >
        <where >
            <foreach collection="oredCriteria" item="criteria" separator="or" >
                <if test="criteria.valid" >
                    <trim prefix="(" suffix=")" prefixOverrides="and" >
                        <foreach collection="criteria.criteria" item="criterion" >
                            <choose >
                                <when test="criterion.noValue" >
                                    and ${criterion.condition}
                                </when>
                                <when test="criterion.singleValue" >
                                    and ${criterion.condition} #{criterion.value}
                                </when>
                                <when test="criterion.betweenValue" >
                                    and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                                </when>
                                <when test="criterion.listValue" >
                                    and ${criterion.condition}
                                    <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                                        #{listItem}
                                    </foreach>
                                </when>
                            </choose>
                        </foreach>
                    </trim>
                </if>
            </foreach>
        </where>
    </sql>

    <sql id="Update_By_Example_Where_Clause" >
        <where >
            <foreach collection="example.oredCriteria" item="criteria" separator="or" >
                <if test="criteria.valid" >
                    <trim prefix="(" suffix=")" prefixOverrides="and" >
                        <foreach collection="criteria.criteria" item="criterion" >
                            <choose >
                                <when test="criterion.noValue" >
                                    and ${criterion.condition}
                                </when>
                                <when test="criterion.singleValue" >
                                    and ${criterion.condition} #{criterion.value}
                                </when>
                                <when test="criterion.betweenValue" >
                                    and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                                </when>
                                <when test="criterion.listValue" >
                                    and ${criterion.condition}
                                    <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                                        #{listItem}
                                    </foreach>
                                </when>
                            </choose>
                        </foreach>
                    </trim>
                </if>
            </foreach>
        </where>
    </sql>

    <sql id="Base_Column_List" >
        id, taskProgress, createTime, GCLB, ZLLB, cityCode, countyCode, creator, modifier, 
        updateTime, sendBack, ZYND, JHND, filesUrl, stat
    </sql>

    <select id="selectByExample" resultMap="BaseResultMap" parameterType="com.yzl.pojo.YzlEpcTaskProgressExample" >
        select
        <if test="distinct" >
            distinct
        </if>
        <include refid="Base_Column_List" />
        from yzl_epc_task_progress
        <if test="_parameter != null" >
            <include refid="Example_Where_Clause" />
        </if>
        <if test="orderByClause != null" >
            order by ${orderByClause}
        </if>
    </select>

    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
        select 
        <include refid="Base_Column_List" />
        from yzl_epc_task_progress
        where id = #{id,jdbcType=BIGINT}
    </select>

    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
        delete from yzl_epc_task_progress
        where id = #{id,jdbcType=BIGINT}
    </delete>

    <delete id="deleteByExample" parameterType="com.yzl.pojo.YzlEpcTaskProgressExample" >
        delete from yzl_epc_task_progress
        <if test="_parameter != null" >
            <include refid="Example_Where_Clause" />
        </if>
    </delete>

    <insert id="insert" parameterType="com.yzl.pojo.YzlEpcTaskProgress" >
        insert into yzl_epc_task_progress (id, taskProgress, createTime, 
            GCLB, ZLLB, cityCode, 
            countyCode, creator, modifier, 
            updateTime, sendBack, ZYND, 
            JHND, filesUrl, stat
            )
        values (#{id,jdbcType=BIGINT}, #{taskprogress,jdbcType=REAL}, #{createtime,jdbcType=TIMESTAMP}, 
            #{gclb,jdbcType=VARCHAR}, #{zllb,jdbcType=VARCHAR}, #{citycode,jdbcType=VARCHAR}, 
            #{countycode,jdbcType=VARCHAR}, #{creator,jdbcType=VARCHAR}, #{modifier,jdbcType=VARCHAR}, 
            #{updatetime,jdbcType=TIMESTAMP}, #{sendback,jdbcType=INTEGER}, #{zynd,jdbcType=VARCHAR}, 
            #{jhnd,jdbcType=VARCHAR}, #{filesUrl,jdbcType=VARCHAR}, #{stat,jdbcType=VARCHAR}
            )
    </insert>

    <insert id="insertSelective" parameterType="com.yzl.pojo.YzlEpcTaskProgress" >
        insert into yzl_epc_task_progress
        <trim prefix="(" suffix=")" suffixOverrides="," >
            <if test="id != null" >
                id,
            </if>
            <if test="taskprogress != null" >
                taskProgress,
            </if>
            <if test="createtime != null" >
                createTime,
            </if>
            <if test="gclb != null" >
                GCLB,
            </if>
            <if test="zllb != null" >
                ZLLB,
            </if>
            <if test="citycode != null" >
                cityCode,
            </if>
            <if test="countycode != null" >
                countyCode,
            </if>
            <if test="creator != null" >
                creator,
            </if>
            <if test="modifier != null" >
                modifier,
            </if>
            <if test="updatetime != null" >
                updateTime,
            </if>
            <if test="sendback != null" >
                sendBack,
            </if>
            <if test="zynd != null" >
                ZYND,
            </if>
            <if test="jhnd != null" >
                JHND,
            </if>
            <if test="filesUrl != null" >
                filesUrl,
            </if>
            <if test="stat != null" >
                stat,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides="," >
            <if test="id != null" >
                #{id,jdbcType=BIGINT},
            </if>
            <if test="taskprogress != null" >
                #{taskprogress,jdbcType=REAL},
            </if>
            <if test="createtime != null" >
                #{createtime,jdbcType=TIMESTAMP},
            </if>
            <if test="gclb != null" >
                #{gclb,jdbcType=VARCHAR},
            </if>
            <if test="zllb != null" >
                #{zllb,jdbcType=VARCHAR},
            </if>
            <if test="citycode != null" >
                #{citycode,jdbcType=VARCHAR},
            </if>
            <if test="countycode != null" >
                #{countycode,jdbcType=VARCHAR},
            </if>
            <if test="creator != null" >
                #{creator,jdbcType=VARCHAR},
            </if>
            <if test="modifier != null" >
                #{modifier,jdbcType=VARCHAR},
            </if>
            <if test="updatetime != null" >
                #{updatetime,jdbcType=TIMESTAMP},
            </if>
            <if test="sendback != null" >
                #{sendback,jdbcType=INTEGER},
            </if>
            <if test="zynd != null" >
                #{zynd,jdbcType=VARCHAR},
            </if>
            <if test="jhnd != null" >
                #{jhnd,jdbcType=VARCHAR},
            </if>
            <if test="filesUrl != null" >
                #{filesUrl,jdbcType=VARCHAR},
            </if>
            <if test="stat != null" >
                #{stat,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>

    <select id="countByExample" parameterType="com.yzl.pojo.YzlEpcTaskProgressExample" resultType="java.lang.Integer" >
        select count(*) from yzl_epc_task_progress
        <if test="_parameter != null" >
            <include refid="Example_Where_Clause" />
        </if>
    </select>

    <update id="updateByExampleSelective" parameterType="map" >
        update yzl_epc_task_progress
        <set >
            <if test="record.id != null" >
                id = #{record.id,jdbcType=BIGINT},
            </if>
            <if test="record.taskprogress != null" >
                taskProgress = #{record.taskprogress,jdbcType=REAL},
            </if>
            <if test="record.createtime != null" >
                createTime = #{record.createtime,jdbcType=TIMESTAMP},
            </if>
            <if test="record.gclb != null" >
                GCLB = #{record.gclb,jdbcType=VARCHAR},
            </if>
            <if test="record.zllb != null" >
                ZLLB = #{record.zllb,jdbcType=VARCHAR},
            </if>
            <if test="record.citycode != null" >
                cityCode = #{record.citycode,jdbcType=VARCHAR},
            </if>
            <if test="record.countycode != null" >
                countyCode = #{record.countycode,jdbcType=VARCHAR},
            </if>
            <if test="record.creator != null" >
                creator = #{record.creator,jdbcType=VARCHAR},
            </if>
            <if test="record.modifier != null" >
                modifier = #{record.modifier,jdbcType=VARCHAR},
            </if>
            <if test="record.updatetime != null" >
                updateTime = #{record.updatetime,jdbcType=TIMESTAMP},
            </if>
            <if test="record.sendback != null" >
                sendBack = #{record.sendback,jdbcType=INTEGER},
            </if>
            <if test="record.zynd != null" >
                ZYND = #{record.zynd,jdbcType=VARCHAR},
            </if>
            <if test="record.jhnd != null" >
                JHND = #{record.jhnd,jdbcType=VARCHAR},
            </if>
            <if test="record.filesUrl != null" >
                filesUrl = #{record.filesUrl,jdbcType=VARCHAR},
            </if>
            <if test="record.stat != null" >
                stat = #{record.stat,jdbcType=VARCHAR},
            </if>
        </set>
        <if test="_parameter != null" >
            <include refid="Update_By_Example_Where_Clause" />
        </if>
    </update>

    <update id="updateByExample" parameterType="map" >
        update yzl_epc_task_progress
        set id = #{record.id,jdbcType=BIGINT},
            taskProgress = #{record.taskprogress,jdbcType=REAL},
            createTime = #{record.createtime,jdbcType=TIMESTAMP},
            GCLB = #{record.gclb,jdbcType=VARCHAR},
            ZLLB = #{record.zllb,jdbcType=VARCHAR},
            cityCode = #{record.citycode,jdbcType=VARCHAR},
            countyCode = #{record.countycode,jdbcType=VARCHAR},
            creator = #{record.creator,jdbcType=VARCHAR},
            modifier = #{record.modifier,jdbcType=VARCHAR},
            updateTime = #{record.updatetime,jdbcType=TIMESTAMP},
            sendBack = #{record.sendback,jdbcType=INTEGER},
            ZYND = #{record.zynd,jdbcType=VARCHAR},
            JHND = #{record.jhnd,jdbcType=VARCHAR},
            filesUrl = #{record.filesUrl,jdbcType=VARCHAR},
            stat = #{record.stat,jdbcType=VARCHAR}
        <if test="_parameter != null" >
            <include refid="Update_By_Example_Where_Clause" />
        </if>
    </update>

    <update id="updateByPrimaryKeySelective" parameterType="com.yzl.pojo.YzlEpcTaskProgress" >
        update yzl_epc_task_progress
        <set >
            <if test="taskprogress != null" >
                taskProgress = #{taskprogress,jdbcType=REAL},
            </if>
            <if test="createtime != null" >
                createTime = #{createtime,jdbcType=TIMESTAMP},
            </if>
            <if test="gclb != null" >
                GCLB = #{gclb,jdbcType=VARCHAR},
            </if>
            <if test="zllb != null" >
                ZLLB = #{zllb,jdbcType=VARCHAR},
            </if>
            <if test="citycode != null" >
                cityCode = #{citycode,jdbcType=VARCHAR},
            </if>
            <if test="countycode != null" >
                countyCode = #{countycode,jdbcType=VARCHAR},
            </if>
            <if test="creator != null" >
                creator = #{creator,jdbcType=VARCHAR},
            </if>
            <if test="modifier != null" >
                modifier = #{modifier,jdbcType=VARCHAR},
            </if>
            <if test="updatetime != null" >
                updateTime = #{updatetime,jdbcType=TIMESTAMP},
            </if>
            <if test="sendback != null" >
                sendBack = #{sendback,jdbcType=INTEGER},
            </if>
            <if test="zynd != null" >
                ZYND = #{zynd,jdbcType=VARCHAR},
            </if>
            <if test="jhnd != null" >
                JHND = #{jhnd,jdbcType=VARCHAR},
            </if>
            <if test="filesUrl != null" >
                filesUrl = #{filesUrl,jdbcType=VARCHAR},
            </if>
            <if test="stat != null" >
                stat = #{stat,jdbcType=VARCHAR},
            </if>
        </set>
        where id = #{id,jdbcType=BIGINT}
    </update>

    <update id="updateByPrimaryKey" parameterType="com.yzl.pojo.YzlEpcTaskProgress" >
        update yzl_epc_task_progress
        set taskProgress = #{taskprogress,jdbcType=REAL},
            createTime = #{createtime,jdbcType=TIMESTAMP},
            GCLB = #{gclb,jdbcType=VARCHAR},
            ZLLB = #{zllb,jdbcType=VARCHAR},
            cityCode = #{citycode,jdbcType=VARCHAR},
            countyCode = #{countycode,jdbcType=VARCHAR},
            creator = #{creator,jdbcType=VARCHAR},
            modifier = #{modifier,jdbcType=VARCHAR},
            updateTime = #{updatetime,jdbcType=TIMESTAMP},
            sendBack = #{sendback,jdbcType=INTEGER},
            ZYND = #{zynd,jdbcType=VARCHAR},
            JHND = #{jhnd,jdbcType=VARCHAR},
            filesUrl = #{filesUrl,jdbcType=VARCHAR},
            stat = #{stat,jdbcType=VARCHAR}
        where id = #{id,jdbcType=BIGINT}
    </update>
    
              <!-- 鏍规嵁宸ョ▼缂栧彿鍒犻櫎 -->
    <delete id="deleteByEcode" parameterType="java.lang.Integer">
    	delete from yzl_epc_task_progress 
    	where GCLB=#{epcode}
    </delete>
    <!-- 鍒嗛〉鏌ヨ鎵�鏈夊伐绋嬬紪鍙峰幓鎺夐噸澶�+鍒嗛〉 -->
    <select id="selectByccEcodePage" resultType="java.lang.Integer">
    	select distinct GCLB from yzl_epc_task_progress limit #{0},#{1}
    </select>
    <!-- 鏌ヨ鎵�鏈夊伐绋嬬紪鍙峰幓鎺夐噸澶� -->
    <select id="selectByDistinctEcode" resultType="java.lang.Integer">
    	select distinct GCLB from yzl_epc_task_progress
    </select>
    
    <select id="selectDistinctByEpcode" resultMap="BaseResultMap">
    	SELECT
		  *
		FROM
		  	yzl_epc_task_progress et
		 where et.GCLB=#{ecode}
    </select>
    <!-- 鏍规嵁鐢ㄦ埛鍚嶆煡璇㈠伐绋嬬紪鍙� -->
    <select id="selectByEpcEname" parameterType="java.lang.String" resultType="java.lang.Integer">
    	SELECT DISTINCT GCLB FROM yzl_epc_task_progress WHERE GCLB=(SELECT DISTINCT ecode FROM yzl_epc WHERE ename=#{ename})
    </select>
    <!-- 妯＄硦鏌ヨ//鏍规嵁杈撳叆鐨勫瓧绗﹀緱鍒板伐绋嬪璞�+鍒嗛〉 -->
    <select id="selectVaguePage" resultType="com.yzl.pojo.YzlEpc">
    	SELECT ecode,ename FROM yzl_epc WHERE ename LIKE "%"#{0}"%" limit #{1},#{2}
    </select>
    <!-- 妯＄硦鏌ヨ//鏍规嵁杈撳叆鐨勫瓧绗﹀緱鍒板伐绋嬪璞� -->
    <select id="selectVague" parameterType="java.lang.String" resultType="com.yzl.pojo.YzlEpc">
    	SELECT ecode,ename FROM yzl_epc WHERE ename LIKE "%"#{value}"%"
    </select>
    
    <!-- 鏍规嵁涓�涓伐绋嬬紪鍙疯繑鍥炲伐绋嬫嫢鏈夌殑鎵�鏈変换鍔″璞� -->
    <select id="selectByEcode" parameterType="java.lang.Integer" resultType="com.yzl.pojo.YzlTask">
    	SELECT tcode,tname 
    	FROM yzl_task 
		WHERE tcode IN(SELECT ZLLB FROM yzl_epc_task_progress WHERE GCLB = #{ecode})
    </select>
    <select id="selectByEcodes" resultType="com.yzl.pojo.YzlTask">
    	SELECT tcode,tname 
    	FROM yzl_task 
		WHERE mark IN(SELECT ZLLB FROM yzl_epc_task_progress WHERE GCLB = #{ecode} and zynd = #{year})
    </select>
    <resultMap id="TaskDistrictResultMap" type="com.yzl.pojo.YzlEpcTaskProgress">
    	<id column="id" property="id"/>
        <result column="taskprogress" property="taskprogress"/>
		<result column="ZLLB" property="zllb"/>
		<result column="GCLB" property="gclb"/>
		<result column="creator" property="creator"/>
		<result column="JHND" property="jhnd"/>
		<result column="ZYND" property="zynd"/>
		<association property="district" javaType="com.yzl.pojo.YzlDistrict">
			<id property="dcode" column="dcode"></id>
			<result property="city" column="city"></result>
			<result property="county" column="county"></result>
			<result property="burg" column="burg"></result>
			<result property="village" column="village"></result>
		</association>
    </resultMap> 
    
    <sql id="TaskProgressDistrictList" >
        id, taskProgress,etp.creator, GCLB, ZLLB,city,d.citycode,county,ZYND,JHND,d.Anumber
    </sql>
     <sql id="TakProgressVO_Result_List" >
         id,sum(taskProgress) as "taskProgress",GCLB, ZLLB,city,etp.cityCode,county,etp.countyCode,ZYND,JHND
    </sql>
    <resultMap id="taskIssuedDTOMap" type="com.yzl.utils.dto.TaskIssuedDTO" >
        <id column="id" property="id" jdbcType="BIGINT" />
        <result column="taskProgress" property="taskNumber" jdbcType="REAL" />
        <result column="GCLB" property="GCLB" jdbcType="INTEGER" />
        <result column="ZLLB" property="ZLLB" jdbcType="INTEGER" />
        <result column="city" property="city" jdbcType="VARCHAR" />
        <result column="county" property="county" jdbcType="TIMESTAMP" />
        <result column="cityCode" property="cityNumber" jdbcType="VARCHAR" />
        <result column="countyCode" property="countyNumber" jdbcType="VARCHAR" />
        <result column="ZYND" property="ZYND" jdbcType="INTEGER" />
        <result column="JHND" property="JHND" jdbcType="INTEGER" />
    </resultMap>
      <!-- 鏍规嵁宸ョ▼id鍏宠仈鏌ヨ鎵�鏈変换鍔¤繘搴︿互鍙婂湴鍖� -->
    <select id="queryByYearAndGCLB" resultMap="taskIssuedDTOMap">
    	SELECT 
 		 <include refid="TakProgressVO_Result_List"></include> 
    	 FROM yzl_epc_task_progress etp 
    		INNER JOIN yzl_district d  
    			ON etp.countyCode= d.Anumber 
   					WHERE  etp.countyCode IN
						<foreach collection="list" item="mark" open="(" close=")" separator="," >
			               #{mark}
			            </foreach> 
		            	AND etp.ZYND LIKE #{year}
		            	<if test="GCLB != null">
		            	  AND etp.GCLB like #{GCLB}
		            	</if>
		            	GROUP BY etp.countyCode,ZYND,GCLB,ZLLB
    					 ORDER BY etp.countyCode DESC 
    </select>
    	<!-- 缁熻浠诲姟杩涘害鏁伴噺骞舵牴鎹湴鍖篿d鍘婚噸澶� -->
    <select id="countTaskNumber" resultType="long">
    	select count(DISTINCT(createTime)) from yzl_epc_task_progress
    </select>
    

    
    
    <select id="selectByCreateTime" parameterType="String" resultMap="TaskDistrictResultMap">
    	select 
         <include refid="TaskProgressDistrictList"></include> 
    	 FROM yzl_epc_task_progress etp 
    		LEFT JOIN yzl_district d  
    			ON etp.countyCode= d.Anumber 
    				LEFT JOIN yzl_epc e 
    					ON etp.GCLB=e.mark 
    					    WHERE 
    					   		etp.countyCode IN
							 	<foreach collection="list" item="mark" open="(" close=")" separator="," >
					               #{mark}
					            </foreach> AND 	
    					    	etp.createTime Like "%#{year}%"
    </select>
    <!-- 鏇存柊鍙戝竷浠诲姟鐨勫熀鏁� -->
    <update id="updateTaskProgress" parameterType="com.yzl.pojo.YzlEpcTaskProgress">
    	UPDATE `yzl_epc_task_progress` 
    	<set>
	    	taskProgress = ${taskprogress},
	    	<if test="dpcode != null">
	    		countyCode =${dpcode},
	    	</if>
    		modifier=#{modifier},
    	</set> 
    	WHERE ZLLB=${tpcode}
    	AND 
    	GCLB = ${epcode} 
    	AND createTime LIKE #{databasetime} 
    </update>
    <!-- 鍒犻櫎涓嬪彂浠诲姟鐨勫熀鏁�  -->
     <delete id="deleteByEcodeAndCreateTime" parameterType="com.yzl.pojo.YzlEpcTaskProgress" >
        delete from yzl_epc_task_progress
			where
	         	createTime LIKE #{databasetime}
	        	AND countyCode=#{dpcode,jdbcType=INTEGER}
	        	AND GCLB=#{epcode,jdbcType=INTEGER}

    </delete>
    
    <select id="selectByDistinctEcodePage" resultType="java.lang.Integer">
		SELECT DISTINCT ecode FROM yzl_task_epc LIMIT #{0},#{1}
    </select>
    
    <!-- 搜索 -->
     <select id="searchKey" parameterType="java.lang.String" resultMap="TaskDistrictResultMap">
		SELECT 
			 <include refid="TaskProgressDistrictList"></include> 
    	 FROM yzl_epc_task_progress etp 
    		LEFT JOIN yzl_district d  
    			ON etp.countyCode= d.Anumber 
    				LEFT JOIN yzl_epc e 
    					ON etp.GCLB=e.mark
    					
			 WHERE 
			 	etp.countyCode IN
			 	<foreach collection="list" item="mark" open="(" close=")" separator="," >
	               #{mark}
	            </foreach> AND
			 	(etp.`creator` like "%"#{searchKey}"%"
			 	OR etp.`modifier` like "%"#{searchKey}"%"
			 	OR d.`city` like "%"#{searchKey}"%"
			 	OR etp.`createTime` like "%"#{searchKey}"%"
			 	OR d.`county` like "%"#{searchKey}"%"
			 	OR d.`burg` like "%"#{searchKey}"%"
			 	OR d.`citycode` like "%"#{searchKey}"%"
			 	OR d.`shortcode` like "%"#{searchKey}"%" 
			 	OR d.`village` like "%"#{searchKey}"%" 
			 	OR d.`burg` like "%"#{searchKey}"%"
			 	OR e.ename like  "%"#{searchKey}"%")
    </select>

    <!-- 根据关键字字指定的工程搜索 -->
     <select id="searchKeyAndEcode" resultMap="TaskDistrictResultMap">
		SELECT 
			 <include refid="TaskProgressDistrictList"></include> 
    	 FROM yzl_epc_task_progress etp 
    		LEFT JOIN yzl_district d  
    			ON etp.countyCode= d.Anumber 
    				LEFT JOIN yzl_epc e 
    					ON etp.GCLB=e.mark
			 WHERE 
			  etp.countyCode IN
			 	<foreach collection="list" item="mark" open="(" close=")" separator="," >
	               #{mark}
	            </foreach> AND
			 	e.ecode=${ecode} AND
			 	(etp.`creator` like "%"#{searchKey}"%"
			 	OR etp.`modifier` like "%"#{searchKey}"%"
			 	OR etp.`createTime` like "%"#{searchKey}"%"
			 	OR d.`city` like "%"#{searchKey}"%"
			 	OR d.`county` like "%"#{searchKey}"%"
			 	OR d.`burg` like "%"#{searchKey}"%"
			 	OR d.`citycode` like "%"#{searchKey}"%"
			 	OR d.`shortcode` like "%"#{searchKey}"%" 
			 	OR d.`village` like "%"#{searchKey}"%" 
			 	OR d.`burg` like "%"#{searchKey}"%"
			 	OR e.ename like  "%"#{searchKey}"%")
    </select>

    <!-- 图形显示 -->
     <select id="queryTaskGroupByCity" resultType="com.yzl.pojo.dto.TaskDTO">
    	SELECT 
 			d.`city`,d.aNumber,SUM(etp.`taskProgress`) as "taskNumber"
    	 FROM yzl_epc_task_progress etp 
    		INNER JOIN yzl_district d  
    			ON etp.countyCode= d.Anumber 		
    			where etp.countyCode in
				<!-- 根据用户权限查询 -->
				 <foreach collection="aNumbers" item="aNumber" open="(" close=")" separator="," >
		               #{aNumber}
		          </foreach>		
		         <if test="year != null">
		         	AND ZYND = #{year}
		         </if> 
		          		 	
		   				 GROUP BY etp.cityCode
    </select>
    
        <!-- 根据关键字字指定的工程搜索 -->
     <select id="queryTaskDistrictByEcodeAndAreaAndYear" resultMap="TaskDistrictResultMap">
		SELECT 
			 <include refid="TaskProgressDistrictList"></include> 
    	 FROM yzl_epc_task_progress etp 
    		LEFT JOIN yzl_district d  
    			ON etp.countyCode= d.Anumber 
    				LEFT JOIN yzl_epc e 
    					ON etp.GCLB=e.mark
			 WHERE 
			  etp.countyCode IN
			 	<foreach collection="list" item="mark" open="(" close=")" separator="," >
	               #{mark}
	            </foreach> 
	            <if test="ecode!=null and ecode!=''">
	            	AND e.ecode=${ecode} 
	            </if>
	            <if test="area!=null and area!=''">
	             AND	d.city like "%"#{area}"%" or d.county like "%"#{area}"%"   
	            </if>
	            <if test="year!=null and year!=''">
	            	AND etp.createTime like #{year}"%" 
	            </if>
			 	
<!-- 			 	(etp.`creator` like "%"#{searchKey}"%"
			 	OR etp.`modifier` like "%"#{searchKey}"%"
			 	OR etp.`createTime` like "%"#{searchKey}"%"
			 	OR d.`city` like "%"#{searchKey}"%"
			 	OR d.`county` like "%"#{searchKey}"%"
			 	OR d.`burg` like "%"#{searchKey}"%"
			 	OR d.`citycode` like "%"#{searchKey}"%"
			 	OR d.`shortcode` like "%"#{searchKey}"%" 
			 	OR d.`village` like "%"#{searchKey}"%" 
			 	OR d.`burg` like "%"#{searchKey}"%"
			 	OR e.ename like  "%"#{searchKey}"%") -->
    </select>

	<select id="selectByCounty" parameterType="java.lang.String" resultType="com.yzl.pojo.YzlEpc">
		
		SELECT * FROM yzl_epc WHERE ecode IN (
		SELECT DISTINCT GCLB FROM yzl_epc_task_progress WHERE countyCode = (
		SELECT mark FROM yzl_district WHERE county = #{county}))
		
	</select>
	
	<select id="selectByEcodeAndDname" resultType="com.yzl.pojo.YzlTask">
		SELECT * FROM yzl_task WHERE tcode IN (
		SELECT ZLLB FROM yzl_epc_task_progress
		WHERE GCLB = #{ecode} AND countyCode = (
		SELECT mark FROM yzl_district WHERE county = #{county}))
	</select>

	<!-- 查询所有 -->
	<select id="selectAll" resultType="com.yzl.pojo.YzlEpcTaskProgress">
		SELECT * FROM yzl_epc_task_progress 
		<where>
			<if test="ecode != null and ecode != ''">
				and GCLB = #{ecode}
			</if>
			<if test="county != null and county != ''">
				and countyCode = #{county}
			</if>
			<if test="tname != null and tname != ''">
				and ZLLB = #{tname}
			</if>
		</where>
	</select>
	
	<!-- 分页查询 -->
	<select id="selectAllPage" resultType="com.yzl.pojo.YzlEpcTaskProgress">
		SELECT * FROM yzl_epc_task_progress
		<where>
			<if test="ecode != null and ecode != ''">
				and GCLB = #{ecode}
			</if>
			<if test="county != null and county != ''">
				and countyCode = #{county}
			</if>
			<if test="tname != null and tname != ''">
				and ZLLB = #{tname}
			</if>
		</where>
		LIMIT #{page},#{rows}
	</select>
	
	<select id="selectByUidAndL" resultType="com.yzl.pojo.YzlEpcTaskProgress">
		 SELECT * FROM yzl_epc_task_progress 
		 <where>
		 	<if test="uid != null and uid != ''">
		 		countyCode IN (
				SELECT DISTINCT perms FROM yzl_menu WHERE menu_id IN(			
				SELECT menu_id FROM yzl_role_menu WHERE role_id IN(
				SELECT role_id FROM yzl_user_role WHERE user_id=#{uid}
				)) )
		 	</if>
		 	<if test="epcode != null and epcode != ''">
		 		AND GCLB = #{epcode}
		 	</if>
		 	<if test="tpcode != null and tpcode != ''">
		 		AND ZLLB = #{tpcode}
		 	</if>
		 	<if test="dpcode != null and dpcode != ''">
		 		AND countyCode = #{dpcode}
		 	</if>
		 </where>
		 <!-- LIMIT #{page},#{rows} -->
	</select>
	
	<select id="selectByUidAndLPage" resultType="com.yzl.pojo.YzlEpcTaskProgress">
		SELECT * FROM yzl_epc_task_progress 
		 <where>
		 	<if test="uid != null and uid != ''">
		 		countyCode IN (
				SELECT DISTINCT perms FROM yzl_menu WHERE menu_id IN(			
				SELECT menu_id FROM yzl_role_menu WHERE role_id IN(
				SELECT role_id FROM yzl_user_role WHERE user_id=#{uid}
				)) )
		 	</if>
		 	<if test="epcode != null and epcode != ''">
		 		AND GCLB = #{epcode}
		 	</if>
		 	<if test="tpcode != null and tpcode != ''">
		 		AND ZLLB = #{tpcode}
		 	</if>
		 	<if test="dpcode != null and dpcode != ''">
		 		AND countyCode = #{dpcode}
		 	</if>
		 </where>
		 LIMIT #{page},#{rows}
	</select>
	
	<select id="findByUid" resultType="com.yzl.pojo.YzlMenu">
		SELECT * FROM yzl_menu	WHERE menu_id IN (
		SELECT menu_id FROM yzl_role_menu WHERE 
		role_id = (SELECT role_id FROM yzl_user_role WHERE user_id = #{uid}))
	</select>
	
	<select id="selectAlls" resultType="com.yzl.pojo.YzlMonitoringstatistics">
		SELECT * FROM yzl_monitoringstatistics 
		<where>
			<if test="ecode != null and ecode != ''">
				and eid = #{ecode}
			</if>
			<if test="dcode != null and dcode != ''">
				and did = #{dcode}
			</if>
			<if test="tcode != null and tcode != ''">
				and tid = #{tcode}
			</if>
			<if test="time != null and time != ''">
				and time = #{time}
			</if>
		</where>
	</select>
	
	<select id="selectAllPages">
		SELECT * FROM yzl_monitoringstatistics
		<where>
			<if test="ecode != null and ecode != ''">
				and eid = #{ecode}
			</if>
			<if test="dcode != null and dcode != ''">
				and did = #{dcode}
			</if>
			<if test="tcode != null and tcode != ''">
				and tid = #{tcode}
			</if>
			<if test="time != null and time != ''">
				and time = #{time}
			</if>
		</where>
		LIMIT #{page},#{rows}
	</select>
	
	
	<!-- 查询任务基数通过County -->
	<select id="selectTaskNumberGroupByCountyAndByMark" resultType="com.yzl.pojo.dto.TaskDTO">
		SELECT d.county, etp.`countyCode` as "aNumber",SUM(etp.`taskProgress`) AS "taskNumber"  
			FROM yzl_epc_task_progress etp
			     INNER JOIN yzl_district d
				     ON etp.`countyCode`=d.Anumber
					   WHERE etp.`countyCode` LIKE #{cityCode}"%"
					   	 and etp.`countyCode` in
						 <foreach collection="aNumbers" item="aNumber" open="(" close=")" separator="," >
				               #{aNumber}
				          </foreach>
				          <if test="year !=null and year !=''">
				             AND ZYND=#{year}
				          </if>
						GROUP BY etp.`countyCode`
	</select>
		<!-- 通过作业年度和地区行政编号查询任务下发数据根据县、工程类别、县级编号进行分组 -->
	<select id="queryTaskIssuedByGroupCountyAndGCLBAndZLLBAndAreaCodeAndGCLB" resultMap="taskIssuedDTOMap">
		SELECT 
		<include refid="TakProgressVO_Result_List"></include>
			FROM yzl_epc_task_progress etp             
			     INNER JOIN yzl_district d
				     ON etp.`countyCode`=d.Anumber
					   	 where etp.`countyCode` in
						 <foreach collection="aNumbers" item="aNumber" open="(" close=")" separator="," >
				               #{aNumber}
				          </foreach>
				          AND etp.`ZYND` like #{year}
				          <if test="GCLB != null">
				          	AND etp.GCLB = #{GCLB}
				          </if>
				          
				          AND 
				          etp.countyCode like #{areaCode}"%"
						GROUP BY d.`county`,etp.`ZYND`,GCLB,ZLLB
						ORDER BY etp.countyCode DESC 
	</select>
	
	<update id="updateByZYNDAndJHNDAndGCLBAndZLLBAndCountyCode" parameterType="com.yzl.pojo.YzlEpcTaskProgress">
		UPDATE yzl_epc_task_progress etp 
			SET etp.`creator` = #{creator}, etp.`taskProgress` = #{taskprogress}
						<if test="filesUrl != null and filesUrl != ''">
							,etp.filesUrl = #{filesUrl,jdbcType=VARCHAR}
						</if>
			<where>
			 	<if test="gclb!=null and gclb!=''">
					 etp.`GCLB` = #{gclb} 
				</if>
				<if test="zllb!=null and zllb!=''">
					 AND etp.`ZLLB` = #{zllb}
				</if>
				<if test="gclb!=null and gclb!=''">
				 	AND etp.countyCode = #{countycode}
				</if>
				<if test="zynd!=null and zynd!=''">
				 	AND etp.ZYND = #{zynd} 
				</if>
				<if test="jhnd!=null and jhnd!=''">
				 	AND etp.JHND = #{jhnd}
				</if>
			</where>
	</update>

	<!-- 删除   通过作业年度，计划年度，工程类别，造林类别，县行政编号 -->
	<delete id="deleteByZYNDAndJHNDAndGCLBAndZLLBAndCountyCode" parameterType="com.yzl.pojo.YzlEpcTaskProgress">
		DELETE 
		  FROM yzl_epc_task_progress etp 
		    WHERE 
		      etp.GCLB AND = #{gclb} 
		      AND etp.ZLLB = #{zllb}
		      AND etp.CountyCode= #{countycode} 
		      AND etp.ZYND =#{zynd}
		      AND etp.JHND = #{jhnd}
	</delete>
	
	<!-- 删除   通过作业年度，计划年度，县行政编号 -->	
	<delete id="deleteByZYNDAndJHNDAndCountyCode">
		DELETE 
		  FROM yzl_epc_task_progress 
		    WHERE
		    1=1
		    <if test="countyCode != null and countyCode != ''">
		      	and `countyCode` = #{countyCode} 
		    </if>
		    <if test="countyCode == null or countyCode == ''">
		    	AND cityCode = #{cityCode}
		    </if>
		      and ZYND = #{ZYND}
		      and JHND = #{JHND}
		      <if test="zllbs.size > 0 and zllbs != null">
		      	and ZLLB in 
		      	<foreach collection="zllbs" item="zl" open="(" separator="," close=")">
		      		#{zl}
		      	</foreach>
		      </if>
		      and GCLB in 
	      		<foreach collection="gclbs" item="gclb" open="(" separator="," close=")">
	      			#{gclb}
	      		</foreach>
	</delete>
	
	<!-- 根据工程id查询对应的造林类别 -->
	<select id="selectByEpcIdAndTime" resultType="com.yzl.pojo.YzlTask">
		SELECT * FROM yzl_task WHERE mark IN (
		SELECT DISTINCT ZLLB FROM yzl_epc_task_progress WHERE ZYND = #{year} AND GCLB = #{epcid}
		)
	</select>
	
	<select id="selectByEpcId" resultType="com.yzl.pojo.YzlEpc">
		SELECT * FROM yzl_epc WHERE mark = #{eid}
	</select>
	
	<select id="selectByTid" resultType="com.yzl.pojo.YzlTask">
		
		SELECT * FROM yzl_task WHERE mark = #{tid}

	</select>

	<select id="countByGCLBAndJHNDAndZYNDAndZLLBAndCountyCode" resultType="int" parameterType="com.yzl.pojo.YzlEpcTaskProgress">
		SELECT COUNT(*) FROM `yzl_epc_task_progress` etp  
		     WHERE 
				etp.GCLB = #{gclb}
				AND etp.ZLLB = #{zllb}
				AND etp.ZYND = #{zynd}
				AND etp.JHND = #{jhnd} 
				AND countyCode = #{countycode}
	</select>
	
	<select id="queryByGCLBAndJHNDAndZYNDAndZLLBAndCountyCode" resultType="com.yzl.pojo.YzlEpcTaskProgress" parameterType="com.yzl.pojo.YzlEpcTaskProgress">
		SELECT * FROM `yzl_epc_task_progress` etp  
		     WHERE 
				etp.GCLB = #{gclb}
				AND etp.ZLLB = #{zllb}
				AND etp.ZYND = #{zynd}
				AND etp.JHND = #{jhnd} 
				AND countyCode = #{countycode}
				<!-- AND stat = #{stat} -->
	</select>

<!-- 	<select id="selectByJhndAndCountyCode" resultType="com.yzl.pojo.YzlEpcTaskProgress" parameterType="com.yzl.pojo.YzlEpcTaskProgress">
		SELECT * FROM `yzl_epc_task_progress` etp  
		     WHERE
		     	etp.JHND = #{jhnd} 
				AND countyCode = #{countycode}
				AND stat = #{stat}
	</select> -->
	
	
	<select id="selectByEpc" resultType="com.yzl.pojo.YzlEpcTaskProgress">
		
		SELECT DISTINCT ZLLB FROM yzl_epc_task_progress WHERE gclb = (
			SELECT mark FROM yzl_epc WHERE ename LIKE #{ename}
		)  AND ZYND = #{year}

	</select>
	
	<select id="selectTaskIssued" resultType="com.yzl.pojo.YzlEpcTaskProgress">
		SELECT SUM(taskProgress) AS taskProgress FROM yzl_epc_task_progress WHERE GCLB = #{gc} AND ZLLB = #{zl} AND countyCode like "%"#{county}"%" AND ZYND = #{time}
	</select>
	
	<sql id="AuthorityToJudgeAndAreaCodeAndJHND"><!-- 判断权限和地区行政编号和作业年度和造林类别 -->
		<if test="year!=null and year!=''">
			and ZYND = #{year}
		</if>
		<if test="areaCode!=null and areaCode!=''">
				AND countyCode LIKE #{areaCode}"%"
		</if>
		<if test="authoritys!=null and authoritys.size>0">
			AND countyCode IN
			<foreach collection="authoritys" item="authority" open="(" separator="," close=")">
				#{authority}
			</foreach>
		</if>
		<if test="ZLLB!=null and ZLLB!='' and ZLLB != 'null'">
			and ZLLB=#{ZLLB}
		</if>
		<if test="GCLB!=null and GCLB!=''">
			and GCLB=#{GCLB}
		</if>
		<!-- <if test="stats !=null and stats !=''">
		and stat in
			<foreach collection="stats" item="st" open="(" separator="," close=")">
				#{st}
			</foreach>
		</if> -->
		order by max(updateTime) desc
	</sql>
	
	
	<select id="queryCityData" resultType="com.yzl.pojo.YzlEpcTaskProgress">
		SELECT id,cityCode,GROUP_CONCAT(DISTINCT(filesUrl)) as filesUrl,countyCode,GCLB,ZLLB,JHND,ZYND,SUM(taskprogress) AS taskprogress,stat FROM `yzl_epc_task_progress` 
					
				where 1=1
				<!-- 判断权限和地区行政编号和作业年度和造林类别 -->
				<!-- <include refid="AuthorityToJudgeAndAreaCodeAndJHND"></include> -->
				
				<if test="year!=null and year!=''">
					and ZYND = #{year}
				</if>
				<if test="areaCode!=null and areaCode!=''">
						AND countyCode LIKE #{areaCode}"%"
				</if>
				<if test="authoritys!=null and authoritys.size>0">
					AND countyCode IN
					<foreach collection="authoritys" item="authority" open="(" separator="," close=")">
						#{authority}
					</foreach>
				</if>
				<if test="ZLLB!=null and ZLLB!='' and ZLLB != 'null'">
					and ZLLB=#{ZLLB}
				</if>
				<if test="GCLB!=null and GCLB!=''">
					and GCLB=#{GCLB}
				</if>
				<if test="stats !=null and stats !=''">
				and stat in
					<foreach collection="stats" item="st" open="(" separator="," close=")">
						#{st}
					</foreach>
				</if>
				GROUP BY GCLB,cityCode,ZLLB,JHND,ZYND 
				order by max(updateTime) desc
	</select>
	
	<select id="queryCountyData"  resultType="com.yzl.pojo.YzlEpcTaskProgress">
		SELECT id,GROUP_CONCAT(DISTINCT(filesUrl)) as filesUrl,cityCode,countyCode,GCLB,ZLLB,JHND,ZYND,SUM(taskprogress) AS taskprogress ,stat FROM `yzl_epc_task_progress` 
						GROUP BY countyCode,GCLB,ZLLB,JHND,ZYND 
				HAVING 1=1  
				<!-- 判断权限和地区行政编号和作业年度和造林类别 -->
				<include refid="AuthorityToJudgeAndAreaCodeAndJHND"></include>
	</select>
	
	<select id="queryCountyDataByParamGroupByCountyAndGCLBAndZLLBAndJHNDAndZYNDAndMessageCounty"  resultType="com.yzl.pojo.YzlEpcTaskProgress">
		SELECT id,GROUP_CONCAT(DISTINCT(filesUrl)) as filesUrl,cityCode,countyCode,GCLB,ZLLB,JHND,ZYND,SUM(taskprogress) AS taskprogress FROM `yzl_epc_task_progress` 
						GROUP BY countyCode,GCLB,ZLLB,JHND,ZYND 
				HAVING 1=1
				<!-- 判断权限和地区行政编号和作业年度和造林类别 -->
				<if test="message.countycode!=null and message.countycode!=''">
					AND countyCode = #{message.countycode}
				</if>
				<if test="message.jhnd!=null and message.jhnd!=''">
					and JHND = #{message.jhnd}
				</if>
				<if test="message.zynd!=null and message.zynd!=''">
					and ZYND = #{message.zynd}
				</if>
				<if test="message.gclb!=null and message.gclb!=''">
					and GCLB = #{message.gclb}
				</if>
				<if test="message.zllb!=null and message.zllb!=''">
					and ZLLB = #{message.zllb}
				</if>
				<include refid="AuthorityToJudgeAndAreaCodeAndJHND"></include>
	</select>
    
<!--        查询工程类别 并去重复
     <select id="queryGCLB" resultType="string">
    	
    	  <where>
    	          判断计划年度、地区行政编号(模糊查询)、权限
    	   		<include refid="AuthorityToJudgeAndAreaCodeAndJHND"></include>
    	   		and ZLLB like #{ZLLB}
    	   </where>
    </select> -->
    
    <select id="selectByZJCCZ" resultType="java.lang.String">
    	SELECT filesUrl FROM yzl_epc_task_progress WHERE JHND = #{jhnd} AND ZYND = #{zynd} 
    	AND GCLB in 
   	  	<foreach collection="gclbs" item="gclb" open="(" separator="," close=")">
   	  		#{gclb}
   	  	</foreach>
   	  	
    	<if test="countyCode!= null and countyCode != ''">
    		AND countyCode = #{countyCode}
    	</if>
    	<if test="countyCode == null or countyCode == ''">
    		AND cityCode = #{cityCode}
    	</if>
    	 <if test="zllbs.size > 0">
    	  AND ZLLB in
    	  	<foreach collection="zllbs" item="zl" open="(" separator="," close=")">
    	  		#{zl}
    	  	</foreach>
    	 </if>
    </select>
    
    <select id="selectByTaskPosessEpc" resultType="java.lang.String">
    	SELECT DISTINCT ZLLB FROM yzl_epc_task_progress WHERE ZYND = #{year} AND gclb = #{gclb} AND countyCode LIKE "%"#{code}"%"
    	<if test="authority.size > 0">
    		AND countyCode IN
    		<foreach collection="authority" item="auth" open="(" separator="," close=")">
    			#{auth}
    		</foreach>
    	</if>
    </select>
    
    <update id="deletefilesUrlByCountCodeAndZYND">
    		UPDATE
    		 yzl_epc_task_progress e
    		 	 SET  filesUrl=#{uploadFiles},`modifier`=#{modifier}
    		 	   WHERE 
    		 	   `zynd`=#{year}
    		 	   	<if test="countyCode!=null and countyCode!=''">
    		 	   	    AND countyCode=#{countyCode} 
    		 	   	</if>
					 <if test="cityCode!=null and cityCode!=''">
    		 	   	    AND cityCode=#{cityCode} 
    		 	   	</if>
    		 	   <if test="deleteFileCode!=null and deleteFileCode!=''">
    		 	   	    AND filesUrl like "%"#{deleteFileCode}"%"
    		 	   	</if>
    </update>
    
        <update id="updatefilesUrlByCountCodeAndZYND">
    		UPDATE
    		 yzl_epc_task_progress e
    		 	 SET  filesUrl=#{filesUrl},`modifier`=#{modifier},updateTime=#{updateTime}
    		 	   where 1=1
    		 	    	 and `zynd`=#{year}
    		 	   	<if test="countyCode!=null and countyCode!=''">
    		 	   	    AND countyCode=#{countyCode} 
    		 	   	</if>
					 <if test="cityCode!=null and cityCode!='' and cityCode!='null'">
    		 	   	    AND cityCode=#{cityCode} 
    		 	   	</if>
    </update>
	
	
	
	<select id="queryCityDataByParamGroupByCountyAndGCLBAndZLLBAndJHNDAndZYNDAndMessageCounty" resultType="com.yzl.pojo.YzlEpcTaskProgress">
		SELECT id,cityCode,GROUP_CONCAT(DISTINCT(filesUrl)) as filesUrl,countyCode,GCLB,ZLLB,JHND,ZYND,SUM(taskprogress) AS taskprogress FROM `yzl_epc_task_progress` 
				where  1=1
				<if test="year!=null and year!=''">
					and ZYND = #{year}
				</if>
				<if test="areaCode!=null and areaCode!=''">
						AND countyCode LIKE #{areaCode}"%"
				</if>
				<if test="authoritys!=null and authoritys.size>0">
					AND countyCode IN
					<foreach collection="authoritys" item="authority" open="(" separator="," close=")">
						#{authority}
					</foreach>
				</if>
				<if test="ZLLB!=null and ZLLB!='' and ZLLB != 'null'">
					and ZLLB=#{ZLLB}
				</if>
				<if test="GCLB!=null and GCLB!=''">
					and GCLB=#{GCLB}
				</if>
				<if test="message.countycode!=null and message.countycode!=''">
					AND countyCode = #{message.countycode}
				</if>
				<if test="message.jhnd!=null and message.jhnd!=''">
					and JHND = #{message.jhnd}
				</if>
				<if test="message.zynd!=null and message.zynd!=''">
					and ZYND = #{message.zynd}
				</if>
				<if test="message.gclb!=null and message.gclb!=''">
					and GCLB = #{message.gclb}
				</if>
				<if test="message.zllb!=null and message.zllb!=''">
					and ZLLB = #{message.zllb}
				</if>
				GROUP BY cityCode,GCLB,ZLLB,JHND,ZYND 
				order by max(updateTime) desc 
				<!-- 判断权限和地区行政编号和作业年度和造林类别 -->
			<!-- 	<include refid="AuthorityToJudgeAndAreaCodeAndJHND"></include> -->
					
	</select>
	
	<select id="selectByProceed" resultType="com.yzl.pojo.YzlEpcTaskProgress">
		SELECT gclb,stat FROM yzl_epc_task_progress 
		WHERE gclb = #{gclb} AND countyCode = #{anumber} AND ZYND = #{year}
		 AND stat in
		 <foreach collection="stats" item="st" open="(" separator="," close=")">
		 	#{st}
		 </foreach>
		 GROUP BY stat
	</select>
</mapper>