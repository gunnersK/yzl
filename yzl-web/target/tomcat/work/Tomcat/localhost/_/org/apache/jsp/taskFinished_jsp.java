/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.47
 * Generated at: 2019-07-16 07:48:54 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import java.text.SimpleDateFormat;
import java.util.Date;

public final class taskFinished_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005fshiro_005fhasPermission_0026_005fname;

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _005fjspx_005ftagPool_005fshiro_005fhasPermission_0026_005fname = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
    _005fjspx_005ftagPool_005fshiro_005fhasPermission_0026_005fname.release();
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=utf-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\r\n");
      out.write("<html>\r\n");
      out.write("<head>\r\n");
      out.write("<meta http-equiv=\"expires\" content=\"0\">\r\n");
      out.write("<meta http-equiv=\"pragma\" content=\"no-cache\">\r\n");
      out.write("<meta http-equiv=\"cache-control\" content=\"no-cache\">\r\n");
      out.write("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\r\n");
      out.write(" <!--  <link href=\"assets/css/bootstrap.min.css\" rel=\"stylesheet\" /> -->\r\n");
      out.write("<!--   <link rel=\"stylesheet\" href=\"assets/css/font-awesome.min.css\" /> -->\r\n");
      out.write("  <link rel=\"stylesheet\" href=\"assets/css/jquery-ui-1.10.3.full.min.css\">\r\n");
      out.write("<!--   <link rel=\"stylesheet\" href=\"assets/css/ace.min.css\" />\r\n");
      out.write("  <link rel=\"stylesheet\" href=\"css/style.css\"/> -->\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath }", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/js/jquery-1.8.3.js\"></script>\r\n");
      out.write("\t<script type=\"text/javascript\" src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/js/jquery-easyui-1.4.1/plugins/jquery.messager.js\"></script>\r\n");
      out.write("<!-- 导入jquery核心类库 -->\r\n");
      out.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath }", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/js/easyui/themes/default/easyui.css\">\r\n");
      out.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath }", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/js/easyui/themes/icon.css\">\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath }", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/js/easyui/locale/easyui-lang-zh_CN.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath }", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/js/easyui/jquery.easyui.min.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath }", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/js/easyui/locale/easyui-lang-zh_CN.js\"></script>\r\n");
      out.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath }", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/js/easyui/themes/default/easyui.css\" />\r\n");
      out.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath }", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/js/easyui/themes/icon.css\" />\r\n");
      out.write("\r\n");
      out.write("<script type=\"text/javascript\" charset=\"utf-8\" src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath }", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/js/app/assets/javascripts/jquery-fileupload/vendor/jquery.ui.widget.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\" charset=\"utf-8\" src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath }", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/js/app/assets/javascripts/jquery-fileupload/jquery.iframe-transport.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\" charset=\"utf-8\" src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath }", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/js/app/assets/javascripts/jquery-fileupload/jquery.fileupload.js\"></script>\r\n");
      out.write("<title>xxx</title>\r\n");
      out.write("<style type=\"text/css\">\r\n");
      out.write(".datagrid-body{\r\n");
      out.write("style:\"width:625px\"\r\n");
      out.write("}\r\n");
      out.write("span.searchbox{\r\n");
      out.write("margin-bottom:-6px;\r\n");
      out.write("}\r\n");
      out.write(".layout-split-west{/* panel layout-panel layout-panel-west  */\r\n");
      out.write("width:155px !important; \r\n");
      out.write("}\r\n");
      out.write(".layout-panel-center{\r\n");
      out.write("left: 156px !important;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("/*a  upload */\r\n");
      out.write(".a-upload {\r\n");
      out.write("    padding: 4px 10px;\r\n");
      out.write("    height: 20px;\r\n");
      out.write("    line-height: 20px;\r\n");
      out.write("    position: relative;\r\n");
      out.write("    cursor: pointer;\r\n");
      out.write("    color: #888;\r\n");
      out.write("    background: #fafafa;\r\n");
      out.write("    border: 1px solid #ddd;\r\n");
      out.write("    border-radius: 4px;\r\n");
      out.write("    overflow: hidden;\r\n");
      out.write("    display: inline-block;\r\n");
      out.write("    *display: inline;\r\n");
      out.write("    *zoom: 1\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write(".a-upload  input {\r\n");
      out.write("    position: absolute;\r\n");
      out.write("    font-size: 100px;\r\n");
      out.write("    right: 0;\r\n");
      out.write("    top: 0;\r\n");
      out.write("    opacity: 0;\r\n");
      out.write("    filter: alpha(opacity=0);\r\n");
      out.write("    cursor: pointer\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write(".a-upload:hover {\r\n");
      out.write("    color: #444;\r\n");
      out.write("    background: #eee;\r\n");
      out.write("    border-color: #ccc;\r\n");
      out.write("    text-decoration: none\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write(".bcbtn{\r\n");
      out.write("border-radius:4px;\r\n");
      out.write("color: gree;\r\n");
      out.write("}\r\n");
      out.write(".qxbtn{\r\n");
      out.write("border-radius:4px;\r\n");
      out.write("}\r\n");
      out.write("/* #labelName{\r\n");
      out.write("position: absolute;\r\n");
      out.write("margin-left:415px;\r\n");
      out.write("margin-top:11px;\r\n");
      out.write("z-index: 1000\r\n");
      out.write("}\r\n");
      out.write(".combo{\r\n");
      out.write("position: absolute;\r\n");
      out.write("margin-left:475px;\r\n");
      out.write("margin-top:8px;\r\n");
      out.write("z-index: 1000\r\n");
      out.write("} */\r\n");
      out.write("</style>\r\n");
      out.write("</head>\r\n");
      out.write("\r\n");
      out.write("<body class=\"easyui-layout\" >\r\n");
      out.write("\t<!-- <div class=\"easyui-layout\" style=\" width: 1280px;height: 550px;margin-top: -5px\"> -->\r\n");
      out.write("\t\t    <div data-options=\"region:'west',title:'',split:true,border : false\" style=\"width:143px;margin-left: 5px;\">\r\n");
      out.write("\t\t\t    <ul id=\"tree\" class=\"easyui-tree\">\r\n");
      out.write("\t\t\t    \r\n");
      out.write("\t\t\t    </ul>\r\n");
      out.write("\t\t    </div>\r\n");
      out.write("\r\n");
      out.write("\t\t    \r\n");
      out.write("\t\t    ");
      out.write("\r\n");
      out.write("\t\t\t<div id=\"ce\" data-options=\"region:'center',title:'',border : false\" style=\"width:1400px;padding:5px;background:#eee;\">\r\n");
      out.write("\t\t\t\t<table id=\"tab\" style=\"display:none;height:530px\"></table>\r\n");
      out.write("\t\t\t</div>\r\n");
      out.write("    <div id=\"tbs\" style=\"height:28px;dispaly:none\">\r\n");
      out.write("\r\n");
      out.write("    \t<label class=\"\" id=\"labelName\" style=\"font-size: 12px;\">造林类别:</label>\r\n");
      out.write("\t\t<input id=\"zllb\" class=\"easyui-combobox\" name=\"dept\" data-options=\"valueField:'mark',textField:'tname',url:'");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath }", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/taskWorking/show_tasks'\" />&nbsp;&nbsp;\r\n");
      out.write("\t\t\t\r\n");
      out.write("       \t<!-- <input id=searchKey value=\"\" class=\"easyui-searchbox\" style=\"width:110px;height:19px;margin-top: 20px\"> -->\r\n");
      out.write("       \t<a href=\"javascript:void(0)\" class=\"easyui-linkbutton\" data-options=\"iconCls:'icon-redo',plain:true\" onclick=\"derive()\">导出</a>\r\n");
      out.write("       \t\r\n");
      out.write("       \t");
      if (_jspx_meth_shiro_005fhasPermission_005f0(_jspx_page_context))
        return;
      out.write("\r\n");
      out.write("       \t&nbsp;&nbsp;\r\n");
      out.write("       \t<label class=\"\" id=\"labelName\" style=\"font-size: 12px;\">年份:</label>\r\n");
      out.write("       \t<input id=year value=");
      out.print(new SimpleDateFormat("yyyy").format(new Date()));
      out.write("; data-options=\"min:2000,max:2050,editable:false\" class=\"easyui-numberspinner\"  style=\"width:70px;;height:19px;margin-top: 0px\">\r\n");
      out.write("       \t<!-- <a href=\"javascript:void(0)\" class=\"easyui-linkbutton\" data-options=\"iconCls:'icon-edit',plain:true\" onclick=\"submit()\">提交</a>\r\n");
      out.write("       \t<a href=\"javascript:void(0)\" class=\"easyui-linkbutton\" data-options=\"iconCls:'icon-back',plain:true\" onclick=\"back()\">退回</a>\r\n");
      out.write("       \t<a href=\"javascript:void(0)\" class=\"easyui-linkbutton\" data-options=\"iconCls:'icon-ok',plain:true\" onclick=\"audit()\">审核</a> -->\r\n");
      out.write("   </div>\r\n");
      out.write("    \r\n");
      out.write("    <script type=\"text/javascript\">\r\n");
      out.write("  //当前登录的用户\r\n");
      out.write("    var usr = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${sessionScope.user.username}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\";\r\n");
      out.write("    var msg;\r\n");
      out.write("    var lea;\r\n");
      out.write("    var sh1 = false;//sh1\r\n");
      out.write("    var sh2 = true;//sh2\r\n");
      out.write("    var disCode;\r\n");
      out.write("    var zllb = null;\r\n");
      out.write("    var muniLength = null;//多少个市\r\n");
      out.write("    var coutyLength = null;//多少个县\r\n");
      out.write("    var countNode = null;//县的节点\r\n");
      out.write("    var cityNode = null;//市的节点\r\n");
      out.write("    var bdgwj = new Array;\r\n");
      out.write("    var clickZllb = null;\r\n");
      out.write("    var backCountys = new Array;\r\n");
      out.write("    //退回\r\n");
      out.write("    function back(){\r\n");
      out.write("    \tvar node =$(\"#tree\").tree('getSelected');//获取选择的节点\r\n");
      out.write("    \tif(node!=null){\r\n");
      out.write("    \t\tdisCode = node.id;\r\n");
      out.write("    \t}else{\r\n");
      out.write("    \t\tnode = \"GX45\";\r\n");
      out.write("    \t}\r\n");
      out.write("    \tvar time = $(\"#year\").val();//获取时间\r\n");
      out.write("    \tvar rows = $(\"#tab\").datagrid('getSelections');//获取选择的行\r\n");
      out.write("    \t\r\n");
      out.write("    \tif(rows.length == 0){\r\n");
      out.write("       \t\t$.messager.alert('错误提示','必须选择一个','info');\r\n");
      out.write("       \t\treturn;\r\n");
      out.write("       \t}\r\n");
      out.write("    \tfor(var i=0;i<rows.length;i++){\r\n");
      out.write("   \t\t\tvar r = JSON.stringify(rows[i]);//转成json串\r\n");
      out.write("       \t\t//将json字符串转成jsn对象\r\n");
      out.write("       \t\tvar JsonObj = eval('('+r+')');\r\n");
      out.write("       \t\tvar states = JsonObj.stat;\r\n");
      out.write("       \t\tvar county = JsonObj.county;\r\n");
      out.write("       \t\t/* if(states == '3' || states == '0'){\r\n");
      out.write("       \t\t\t$.messager.alert('错误提示','未提交不能退回！！','info');\r\n");
      out.write("           \t\treturn;\r\n");
      out.write("       \t\t} */\r\n");
      out.write("           \tif(county == undefined){\r\n");
      out.write("           \t\t$.messager.alert('错误提示','<h3>不能退回市！！</h3>','info');\r\n");
      out.write("           \t\treturn ;\r\n");
      out.write("           \t}else{\r\n");
      out.write("           \t\tbackCountys.push(county);\r\n");
      out.write("           \t}\r\n");
      out.write("   \t\t}\r\n");
      out.write("    \t\r\n");
      out.write("    \tvar backData = new Array(); //退回单条数据\t\r\n");
      out.write("    \tvar backDatas = new Array();\t//退回多条数据\r\n");
      out.write("    \tif(rows.length == 1){\r\n");
      out.write("    \t\tbackDatas.push(JSON.stringify(rows[0]));\r\n");
      out.write("    \t}else{\r\n");
      out.write("    \t\tfor(var i=0;i<rows.length;i++){\r\n");
      out.write("        \t\tvar ro = JSON.stringify(rows[i]);\r\n");
      out.write("        \t\tbackData.push(ro);\r\n");
      out.write("        \t}\r\n");
      out.write("    \t}\r\n");
      out.write("    \t\r\n");
      out.write("    \tif(sh2){\r\n");
      out.write("    \t\t$(\"#upt\").window(\"open\");\r\n");
      out.write("    \t}\r\n");
      out.write("    \tif(sh1){\r\n");
      out.write("\t\t   \t\t\tvar backData = new Array();\r\n");
      out.write("\t\t   \t    \tvar backDatas = new Array();\r\n");
      out.write("\t\t   \t    \t\r\n");
      out.write("\t\t   \t    \tif(rows.length == 1){\r\n");
      out.write("\t\t   \t    \t\tbackDatas.push(JSON.stringify(rows[0]));\r\n");
      out.write("\t\t   \t    \t}else{\r\n");
      out.write("\t\t   \t    \t\tfor(var i=0;i<rows.length;i++){\r\n");
      out.write("\t\t   \t        \t\tvar ro = JSON.stringify(rows[i]);\r\n");
      out.write("\t\t   \t        \t\tbackData.push(ro);\r\n");
      out.write("\t\t   \t        \t}\r\n");
      out.write("\t\t   \t    \t}\r\n");
      out.write("\t\t   \t    \t\r\n");
      out.write("\t\t   \t    \t$.ajaxSettings.async = false;//取消异步\r\n");
      out.write("\t\t   \t    \t$.ajax({\r\n");
      out.write("\t\t   \t    \t\ttype:'post',\r\n");
      out.write("\t\t   \t    \t\ttraditional: true,\r\n");
      out.write("\t\t   \t    \t\tasync:false,\r\n");
      out.write("\t\t   \t    \t\turl:'");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/completionTask/backData',\r\n");
      out.write("\t\t   \t    \t\tdata:{'backData':backData,\"disCode\":disCode,\"usr\":usr,'backDatas':backDatas,\"time\":time,\"lea\":lea,\"fileNames\":bdgwj,\"zllb\":zllb,\"countys\":backCountys},\r\n");
      out.write("\t\t   \t\t\t\tdataType:'json',\r\n");
      out.write("\t\t   \t    \t\tsuccess:function(data){\r\n");
      out.write("\t\t   \t\t\t\t\tif(data.data==200){\r\n");
      out.write("\t\t   \t\t\t\t\t\t$.messager.alert('提示框','成功','info');\r\n");
      out.write("\t\t   \t\t\t\t\t\t//$(\"#tab\").datagrid('load');\r\n");
      out.write("\t\t   \t\t\t\t\t\tinit();\r\n");
      out.write("\t\t   \t\t\t\t    \tinTable();\r\n");
      out.write("\t\t   \t\t\t\t\t\t$(\"#tbody\").html(\"\");\r\n");
      out.write("\t\t   \t\t\t\t\t\tbdgwj = [];\r\n");
      out.write("\t\t   \t\t\t\t\t}else{\r\n");
      out.write("\t\t   \t\t\t\t\t\t$.messager.alert('提示框','失败','info');\r\n");
      out.write("\t\t   \t\t\t\t\t}\r\n");
      out.write("\t\t   \t\t\t\t},\r\n");
      out.write("\t\t   \t    \t});\r\n");
      out.write("\t\t   \t\tsh1=false;\r\n");
      out.write("            \tsh2=true;\r\n");
      out.write("    \t}\r\n");
      out.write("    }\r\n");
      out.write("    \r\n");
      out.write("    //选择 查看工程触发\r\n");
      out.write("/*     $(\"#zllb\").combobox({\r\n");
      out.write("    \tonSelect:changed\r\n");
      out.write("    }); */\r\n");
      out.write("  \t//存储添加固定表头的数据\r\n");
      out.write("\tvar frozenColumnsTab = new Array();\r\n");
      out.write("\tvar columnsTabHead = new Array();\r\n");
      out.write("  \tfunction changed(){\r\n");
      out.write("  \t\tfrozenColumnsTab = new Array();\r\n");
      out.write("    \tcolumnsTabHead = new Array();\r\n");
      out.write("    \t\r\n");
      out.write("    \tvar columnsOneTab = new Array();\r\n");
      out.write("    \tvar columnsTowTab = new Array();\r\n");
      out.write("    \tvar columnsThreeTab = new Array();\r\n");
      out.write("    \t\r\n");
      out.write("\t  \t//获取时间\r\n");
      out.write("\t    var year = $(\"#year\").val();\r\n");
      out.write("\t    var node =$(\"#tt\").tree('getSelected');//点击的行政编号\r\n");
      out.write("\t    zllb = $(\"#zllb\").combobox('getValue');//工程编号\r\n");
      out.write("\t\tvar text = $(\"#task\").combobox('getText');//工程名称\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tvar oldNode = null;\r\n");
      out.write("    \tvar id = null;\r\n");
      out.write("    \tif(node != null && node.id != \"45\"){\r\n");
      out.write("    \t\t\toldNode = node;\r\n");
      out.write("    \t\t\tid = oldNode.id;\r\n");
      out.write("    \t}\r\n");
      out.write("    \t//判断是否只有一个市和一个县/为县管理员\r\n");
      out.write("        if(muniLength == 1 && coutyLength == 1){\r\n");
      out.write("        \tnode = countNode;\r\n");
      out.write("        }\r\n");
      out.write("    \t\r\n");
      out.write("    \t//muniLength=1和coutyLength大于1说明是市管理员\r\n");
      out.write("        if(muniLength == 1 && coutyLength > 1){\r\n");
      out.write("        \tnode = cityNode;\r\n");
      out.write("        }\r\n");
      out.write("        var pattern3 = new RegExp(\"[0-9]+\");\r\n");
      out.write("        if(muniLength == 1 && coutyLength > 1 && pattern3.test(id)){\r\n");
      out.write("        \tnode = oldNode;\r\n");
      out.write("        }\r\n");
      out.write("        \r\n");
      out.write("\t  \tif(node!=null){\r\n");
      out.write("\t\t\tif(node.id != \"45\"){\r\n");
      out.write("\t\t\t\tdisCode = node.id;\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\t//如果为市\r\n");
      out.write("\t\t\t\tvar pattern2 = new RegExp(\"[A-Za-z]+\");\r\n");
      out.write("\t    \t\tif(pattern2.test(node.id)){\r\n");
      out.write("\t    \t\t\tfrozenColumnsTab.push(\r\n");
      out.write("\t    \t\t\t\t\t[\r\n");
      out.write("\t    \t\t\t\t\t\t{align:'center',width:100,title:'序号',  rowspan:'2',\tfield:'ck',checkbox:true},\r\n");
      out.write("\t    \t\t\t\t\t{field:'city',title:'市',width:100,rowspan:'2',align:'center'}, \r\n");
      out.write("\t    \t    \t\t\t{field:'county',title:'县',width:100,rowspan:'2',align:'center'},\r\n");
      out.write("\t       \t    \t\t   {field:'particulars',title:'操作详情',width:60,rowspan:'2',align:'center'},\r\n");
      out.write("\t    \t\t\t\t]);\r\n");
      out.write("\t    \t\t}\r\n");
      out.write("\t    \t\t\r\n");
      out.write("\t    \t\t//验证是否是数字\r\n");
      out.write("\t    \t   \t//是说明是县\r\n");
      out.write("\t    \t\tvar pattern3 = new RegExp(\"[0-9]+\");\r\n");
      out.write("\t    \t\tif(pattern3.test(node.id)){\r\n");
      out.write("\t    \t\t\tfrozenColumnsTab.push(\r\n");
      out.write("\t    \t\t\t\t\t[\r\n");
      out.write("\t    \t\t\t\t\t\t{align:'center',width:100,title:'序号',  rowspan:'2',\tfield:'ck',checkbox:true},\r\n");
      out.write("\t       \t    \t\t   {field:'particulars',title:'操作详情',width:60,rowspan:'2',align:'center'},\r\n");
      out.write("\t    \t\t\t\t]);\r\n");
      out.write("\t    \t\t\t$.ajax({\r\n");
      out.write("\t    \t\t\t\tasync:false,\r\n");
      out.write("\t    \t\t\t\turl:'");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/takWorking/Ddis',\r\n");
      out.write("\t    \t\t\t\tdataType:'json',\r\n");
      out.write("\t    \t\t\t\tdata:{\"dcode\":node.id},\r\n");
      out.write("\t    \t\t\t\tsuccess:function(data){\r\n");
      out.write("\t    \t\t\t\t\tdisCode = data.anumber;\r\n");
      out.write("\t    \t\t\t\t},\r\n");
      out.write("\t    \t\t\t\t\r\n");
      out.write("\t    \t\t\t});\r\n");
      out.write("\t    \t\t}\r\n");
      out.write("\t    \t\t\r\n");
      out.write("\t\t\t}else{\r\n");
      out.write("\t\t\t\tfrozenColumnsTab.push(\r\n");
      out.write("\t\t\t\t\t\t[\r\n");
      out.write("\t\t\t\t\t\t\t/* {field:'',title:'',checkbox=\"true\",align:'center'}, */\r\n");
      out.write("\t\t\t\t\t\t\t{align:'center',width:100,title:'序号',  rowspan:'2',\tfield:'ck',checkbox:true},\r\n");
      out.write("\t\t\t\t\t\t\t{field:'city',title:'市',width:100,rowspan:'2',align:'center'}, \r\n");
      out.write("\t\t    \t\t\t/* {field:'county',title:'县',width:100,rowspan:'2',align:'center'}, */\r\n");
      out.write("\t\t\t\t\t]);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}else{\r\n");
      out.write("\t\t\tfrozenColumnsTab.push(\r\n");
      out.write("\t\t\t\t\t[\r\n");
      out.write("\t\t\t\t\t\t/* {field:'',title:'',checkbox=\"true\",align:'center'}, */\r\n");
      out.write("\t\t\t\t\t\t{align:'center',width:100,title:'序号',  rowspan:'2',\tfield:'ck',checkbox:true},\r\n");
      out.write("\t\t\t\t\t\t{field:'city',title:'市',width:100,rowspan:'2',align:'center'}, \r\n");
      out.write("\t    \t\t\t/* {field:'county',title:'县',width:100,rowspan:'2',align:'center'}, */\r\n");
      out.write("\t\t\t\t]);\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t$.ajax({\r\n");
      out.write("\t\t\ttype:'post',\r\n");
      out.write("\t\t\ttraditional: true,\r\n");
      out.write("\t\t\tasync:false,\r\n");
      out.write("\t\t\turl:'");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/Completion/taskTab',\r\n");
      out.write("\t\t\tdata:{\"year\":year,\"zllb\":zllb,\"disCode\":disCode},\r\n");
      out.write("\t\t\tdataType:'json',\r\n");
      out.write("\t\t\tsuccess:function(data){\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t    \tfor(var i=0;i<data.length;i++){\r\n");
      out.write("\t\t\t\t\tcolumnsOneTab.push({field:'',title:data[i].tname,width:100*data[i].list.length,colspan:data[i].list.length*3,align:'center'});\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\tvar epc = data[i].list;\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\tif(data[i].list.length > 0){\r\n");
      out.write("\t\t\t\t\t\tfor(var j=0;j<epc.length;j++){\r\n");
      out.write("\t\t\t\t\t\t\tvar ename = epc[j].ename;\r\n");
      out.write("\t\t\t\t\t\t\tvar field = epc[j].field;\r\n");
      out.write("\t\t\t\t\t\t\tcolumnsTowTab.push({title:''+ename+'',width:100*3,align:'center',colspan:3});//field:''+field+'',\r\n");
      out.write("\t\t\t\t\t\t\tcolumnsThreeTab.push({field:'jh'+data[i].mark+\"Y\"+epc[j].mark,title:'计划',width:100,align:'center'},\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t {field:'wc'+data[i].mark+\"Y\"+epc[j].mark,title:'完成',width:100,align:'center'},\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t {field:'zjh'+data[i].mark+\"Y\"+epc[j].mark,title:'占计划%',width:100,align:'center'});\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t    \tcolumnsTabHead.push(columnsOneTab);\r\n");
      out.write("\t\t\t\tcolumnsTabHead.push(columnsTowTab);\r\n");
      out.write("\t\t\t\tcolumnsTabHead.push(columnsThreeTab);\r\n");
      out.write("\t\t    \t\r\n");
      out.write("\t\t\t\tinTable();\r\n");
      out.write("\t\t\t},\r\n");
      out.write("\t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("  \t}\r\n");
      out.write("    \r\n");
      out.write("\t//数据导出\r\n");
      out.write("    function derive(){\r\n");
      out.write("\t\tvar disCode = \"45\";\r\n");
      out.write("    \tvar node =$(\"#tree\").tree('getSelected');//获取选择的节点\r\n");
      out.write("    \t//获取时间\r\n");
      out.write("    \tvar year = $(\"#year\").val();\r\n");
      out.write("\t\tvar oldNode = null;\r\n");
      out.write("    \tvar id =\"1\";\r\n");
      out.write("    \tif(node != null && node.id != \"45\"){\r\n");
      out.write("    \t\t\toldNode = node;\r\n");
      out.write("    \t\t\tid = oldNode.id;\r\n");
      out.write("    \t\t\tdisCode = id;\r\n");
      out.write("    \t}\r\n");
      out.write("    \t//判断是否只有一个市和一个县/为县管理员\r\n");
      out.write("        if(muniLength == 1 && coutyLength == 1){\r\n");
      out.write("        \tnode = countNode;\r\n");
      out.write("        \tdisCode = countNode.id;\r\n");
      out.write("        \tid = disCode;\r\n");
      out.write("        }\r\n");
      out.write("    \t\r\n");
      out.write("    \t//muniLength=1和coutyLength大于1说明是市管理员\r\n");
      out.write("        if(muniLength == 1 && coutyLength > 1){\r\n");
      out.write("        \t//node = cityNode;\r\n");
      out.write("        \tdisCode = cityNode.id;\r\n");
      out.write("        \tid = disCode;\r\n");
      out.write("        }\r\n");
      out.write("        //var pattern3 = new RegExp(\"[0-9]+\");\r\n");
      out.write("        if(muniLength == 1 && coutyLength  > 1 && id.length >= 6){\r\n");
      out.write("        \tdisCode = node.id;\r\n");
      out.write("        \tid = disCode;\r\n");
      out.write("        }\r\n");
      out.write("    \twindow.location.href=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/completionTask/derive?nid=\"+id+'&year='+year+\"&disCode=\"+disCode+\"&zllb=\"+zllb;\r\n");
      out.write("    }\r\n");
      out.write("\r\n");
      out.write("\t\r\n");
      out.write("    //页面加载\r\n");
      out.write("    $(function(){\r\n");
      out.write("    \t$.ajaxSettings.async=false;//取消异步\r\n");
      out.write("    \t//初始化树\r\n");
      out.write("    \t//初始化树\r\n");
      out.write("    $(\"#tree\").tree({\r\n");
      out.write("   \t\turl:'");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/district/queryTreeNode',\r\n");
      out.write("   \t\tanimate:true,\r\n");
      out.write("   \t\tonClick:click,\r\n");
      out.write("   \t\tonLoadSuccess:success\r\n");
      out.write("   \t});\r\n");
      out.write("        /* $(\"#tt\").tree({\r\n");
      out.write("       \t\turl:'");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/show_dis',\r\n");
      out.write("       \t\tanimate:true,\r\n");
      out.write("       \t\tonClick:click,\r\n");
      out.write("       \t\tonLoadSuccess:success\r\n");
      out.write("       \t}); */\r\n");
      out.write("    \tinit();\r\n");
      out.write("    \tinTable();\r\n");
      out.write("    \t//文件上传\r\n");
      out.write("    \t$('#fileupload').fileupload({\r\n");
      out.write("            dataType: 'json',\r\n");
      out.write("            done: function (e, data) {\r\n");
      out.write("            \t\r\n");
      out.write("\t\t\t\tvar st = data.result.data;\r\n");
      out.write("            \t\r\n");
      out.write("            \tvar upFilename = data.result.msg;\r\n");
      out.write("            \tvar upFilenames = upFilename.split(\"/\");\r\n");
      out.write("            \t\r\n");
      out.write("            \tvar fileName=null;\r\n");
      out.write("            \tif(upFilenames.length > 1){\r\n");
      out.write("            \t\tfileName = upFilenames[2];\r\n");
      out.write("            \t}\r\n");
      out.write("            \t//$(\"#upt\").window(\"close\");\r\n");
      out.write("            \tif(data.result.data == 200){\r\n");
      out.write("            \t\t$(\"#spaninfo\").css(\"color\",\"green\");\r\n");
      out.write("            \t\t$(\"#spaninfo\").html(\"上传成功\");\r\n");
      out.write("            \t\t$(\"#tbody\").append(\"<tr> <td style='border-color:gray' align='center'>\"+fileName+\"</td> <td style='border-color:gray' align='center'><button class='bcbtn' id='\"+data.result.msg+\"' onclick='delFileName(this)'>删除</button></td> <td style='display: none'></td> </tr>\");\r\n");
      out.write("            \t}\r\n");
      out.write("            \r\n");
      out.write("            \tmsg = data.result.msg;\r\n");
      out.write("            \tbdgwj.push(msg);\r\n");
      out.write("            \t\r\n");
      out.write("               /*  $.each(data.result.files, function (index, file) { */\r\n");
      out.write("                    /* $('<p/>').text(file.name).appendTo(document.body); */\r\n");
      out.write("                 /*    console.info(index);\r\n");
      out.write("                    console.info(file);\r\n");
      out.write("                }); */\r\n");
      out.write("            }\r\n");
      out.write("        });\r\n");
      out.write("    })\r\n");
      out.write("    function success(node,data){\r\n");
      out.write("  \t\t//获取所有的市\r\n");
      out.write("  \t\tvar children = data[0].children;\r\n");
      out.write("  \t\t//console.info(children);\r\n");
      out.write("  \t\t\r\n");
      out.write("  \t\t//多少个市\r\n");
      out.write("  \t\t muniLength = children.length;\r\n");
      out.write("  \t\t//console.info(muniLength);\r\n");
      out.write("  \t\t\r\n");
      out.write("  \t\t//获取第一个市下的县\r\n");
      out.write("  \t\tvar second = children[0].children;\r\n");
      out.write("  \t\t//console.info(second);\r\n");
      out.write("  \t\t\r\n");
      out.write("  \t\t//多少个县\r\n");
      out.write("  \t\t coutyLength = second.length;\r\n");
      out.write("  \t\t//console.info(coutyLength);\r\n");
      out.write("  \t\tvar a = second.target;\r\n");
      out.write("  \t\t//条件满足说明为县\r\n");
      out.write("  \t\tif(muniLength == 1 && coutyLength == 1){\r\n");
      out.write("  \t\t\t//disCode = second[0].id;\r\n");
      out.write("  \t\t\t\r\n");
      out.write("  \t\t\tvar tar = $(\"#tree\").tree(\"find\",second[0].id);\r\n");
      out.write("  \t\t\tcountNode = tar;\r\n");
      out.write("  \t\t\t//var bo = $(\"#tt\").tree(\"select\",tar);\r\n");
      out.write("  \t\t\t//$(\"#tt\").tree(\"setValue\",disCode);\r\n");
      out.write("  \t\t\t//click(second);\r\n");
      out.write("  \t\t}\r\n");
      out.write("  \t\tif(muniLength == 1 && coutyLength > 1){\r\n");
      out.write("  \t\t\tvar tar = $(\"#tree\").tree(\"find\",children[0].id);\r\n");
      out.write("  \t\t\tcityNode = tar;\r\n");
      out.write("  \t\t}\r\n");
      out.write("  \t}\r\n");
      out.write("\t\r\n");
      out.write("\r\n");
      out.write("    //页面初始化时 加载表头数据\r\n");
      out.write("    function init(){\r\n");
      out.write("    \tvar year = $(\"#year\").val();\r\n");
      out.write("    \tfrozenColumnsTab = new Array();\r\n");
      out.write("    \tcolumnsTabHead = new Array();\r\n");
      out.write("    \t\r\n");
      out.write("    \tvar columnsOneTab = new Array();\r\n");
      out.write("    \tvar columnsTowTab = new Array();\r\n");
      out.write("    \tvar columnsThreeTab = new Array();\r\n");
      out.write("    \t\r\n");
      out.write("    \tvar node =$(\"#tree\").tree('getSelected');//获取选择的节点\r\n");
      out.write("    \t zllb = $(\"#zllb\").combobox('getValue');//造林类别\r\n");
      out.write("    \tvar disCode = \"GX45\";//地区编号\r\n");
      out.write("    \t\r\n");
      out.write("   \t\tvar oldNode = null;\r\n");
      out.write("  \t\tvar id = \"1\";\r\n");
      out.write("  \t\tif(node != null && node.id != \"45\"){\r\n");
      out.write("  \t\t\toldNode = node;\r\n");
      out.write("  \t\t\tid = oldNode.id;\r\n");
      out.write("  \t\t\tdisCode = id;\r\n");
      out.write("  \t\t}\r\n");
      out.write("  \t\t//判断是否只有一个市和一个县/为县管理员\r\n");
      out.write("      \tif(muniLength == 1 && coutyLength == 1){\r\n");
      out.write("      \t\tnode = countNode;\r\n");
      out.write("      \t}\r\n");
      out.write("  \t\r\n");
      out.write("\t  \t//muniLength=1和coutyLength大于1说明是市管理员\r\n");
      out.write("\t     if(muniLength == 1 && coutyLength > 1){\r\n");
      out.write("\t     \tnode = cityNode;\r\n");
      out.write("\t     }\r\n");
      out.write("\t    // var pattern3 = new RegExp(\"[0-9]+\");\r\n");
      out.write("\t     if(muniLength == 1 && coutyLength > 1 && id.length >= 6){// > 1 && pattern3.test(id)\r\n");
      out.write("\t     \tnode = oldNode;\r\n");
      out.write("\t     }\r\n");
      out.write("    \t\r\n");
      out.write("   \t\tif(node!=null && node.id != \"45\"){//判断是否是自治区  GX450==自治区\r\n");
      out.write("   \t\t\tdisCode = node.id;\r\n");
      out.write("   \t\t\t//如果为市\r\n");
      out.write("      \t\t\tfrozenColumnsTab.push([\r\n");
      out.write("     \t\t\t\t\t{align:'center',width:100,title:'序号',  rowspan:'3',frozen:true,field:'id',checkbox:true},\r\n");
      out.write("      \t\t\t\t\t{field:'city',title:'市',width:100,rowspan:'3',align:'center'}, \r\n");
      out.write("      \t    \t\t\t{field:'county',title:'县',width:100,rowspan:'3',align:'center'},\r\n");
      out.write("      \t    \t\t\t{field:'particulars',title:'操作详情',width:60,rowspan:'3',align:'center'},\r\n");
      out.write("      \t\t\t]);\r\n");
      out.write("   \t\t}else{//自治区进行初始化\r\n");
      out.write("   \t\t\t\r\n");
      out.write("   \t\t\tfrozenColumnsTab.push([{align:'center',width:100,title:'序号',  rowspan:'3',frozen:true,\tfield:'id',checkbox:true},{field:'city',title:'市',width:100,rowspan:'3',align:'center'}]);\r\n");
      out.write("   \t\t\r\n");
      out.write("   \t\t}\r\n");
      out.write("    \t\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t//获取数据库中的数据表头\r\n");
      out.write("\t\t$.ajax({\r\n");
      out.write("\t\t\tasync:false,\r\n");
      out.write("\t\t\turl:'");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath }", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/completionTask/taskTab',\r\n");
      out.write("\t\t\tdataType:'json',\r\n");
      out.write("\t\t\tdata:{\"year\":year,\"disCode\":disCode,\"usr\":usr,\"zllb\":zllb},\r\n");
      out.write("\t\t\tsuccess:function(data){\r\n");
      out.write("\t\t\t\tfor(var i=0;i<data.length;i++){\t\t\t\t\r\n");
      out.write("\t\t\t\t\tif(node == null || node.id == \"45\"){\r\n");
      out.write("\t\t\t\t\t\tcolumnsOneTab.push({field:data[i].mark+\"zl\",title:data[i].tname,width:100,rowspan:3,align:'center'});\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\tfor(var i=0;i<data.length;i++){\r\n");
      out.write("\t    \t\t\t//frozenColumnsTab.push({field:'county',title:'县',width:100,rowspan:'2',align:'center'});\r\n");
      out.write("\t\t\t\t\tcolumnsOneTab.push({field:'',title:data[i].tname,width:100*data[i].list.length,colspan:data[i].list.length*3,align:'center'});\r\n");
      out.write("\t\t\t\t\tvar epc = data[i].list;\r\n");
      out.write("\t\t\t\t\tif(data[i].list.length > 0){\r\n");
      out.write("\t\t\t\t\t\tfor(var j=0;j<epc.length;j++){\r\n");
      out.write("\t\t\t\t\t\t\tvar ename = epc[j].ename;\r\n");
      out.write("\t\t\t\t\t\t\tvar field = epc[j].field;\r\n");
      out.write("\t\t\t\t\t\t\tcolumnsTowTab.push({title:''+ename+'',width:100*3,align:'center',colspan:3});//field:''+field+'',\r\n");
      out.write("\t\t\t\t\t\t\tcolumnsThreeTab.push({field:'jh'+data[i].mark+\"Y\"+epc[j].mark,title:'计划',width:100,align:'center'},\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t {field:'wc'+data[i].mark+\"Y\"+epc[j].mark,title:'完成',width:100,align:'center'},\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t {field:'zjh'+data[i].mark+\"Y\"+epc[j].mark,title:'占计划%',width:100,align:'center'});\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t},\r\n");
      out.write("\t\t});\r\n");
      out.write("\t\tcolumnsTabHead.push(columnsOneTab);\r\n");
      out.write("\t\tcolumnsTabHead.push(columnsTowTab);\r\n");
      out.write("\t\tcolumnsTabHead.push(columnsThreeTab);\r\n");
      out.write("\t}\r\n");
      out.write("\t//选择 查看工程触发\r\n");
      out.write("    $(\"#zllb\").combobox({\r\n");
      out.write("    \tonSelect:changed\r\n");
      out.write("    });\r\n");
      out.write("\t\r\n");
      out.write("\t\tfunction changed(){\r\n");
      out.write("\t\t\tinit();//获取数据表格表头数据\r\n");
      out.write("\t\t\tinTable();//初始化数据表格\r\n");
      out.write("\t    }\r\n");
      out.write("    \r\n");
      out.write("    //初始化表格\r\n");
      out.write("    //初始化表格数据\r\n");
      out.write("    function inTable(){\r\n");
      out.write("    \t\r\n");
      out.write("\tvar node =$(\"#tree\").tree('getSelected');//获取选择的节点\r\n");
      out.write("    \t\r\n");
      out.write("    \tvar disCode = \"GX45\";\r\n");
      out.write("    \t/* var zllb = $(\"#zllb\").combobox('getValue');//造林类别\r\n");
      out.write("\t\tif(node != null && node.id != null){\r\n");
      out.write("\t\t\tdisCode = node.id;//地区行政编号\r\n");
      out.write("\t\t} */\r\n");
      out.write("\t\tvar oldNode = null;\r\n");
      out.write("    \tvar id = \"1\";\r\n");
      out.write("    \tif(node != null && node.id != \"45\"){\r\n");
      out.write("    \t\t\toldNode = node;\r\n");
      out.write("    \t\t\tid = oldNode.id;\r\n");
      out.write("    \t\t\tdisCode = id;\r\n");
      out.write("    \t}\r\n");
      out.write("    \t//判断是否只有一个市和一个县/为县管理员\r\n");
      out.write("        if(muniLength == 1 && coutyLength == 1){\r\n");
      out.write("        \tnode = countNode;\r\n");
      out.write("        \tdisCode = countNode.id;\r\n");
      out.write("        }\r\n");
      out.write("    \t\r\n");
      out.write("    \t//muniLength=1和coutyLength大于1说明是市管理员\r\n");
      out.write("        if(muniLength == 1 && coutyLength > 1){\r\n");
      out.write("        \t//node = cityNode;\r\n");
      out.write("        \tdisCode = cityNode.id;\r\n");
      out.write("        }\r\n");
      out.write("        //var pattern3 = new RegExp(\"[0-9]+\");\r\n");
      out.write("        if(muniLength == 1 && coutyLength  > 1 && id.length >= 6){\r\n");
      out.write("        \tdisCode = node.id;\r\n");
      out.write("        }\r\n");
      out.write("    \t//获取时间\r\n");
      out.write("    \tvar year = $(\"#year\").val();\r\n");
      out.write("    \tvar url = encodeURI('");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/completionTask/epcTaskData?year='+year+'&disCode='+disCode+'&usr='+usr+'&zllb='+zllb);\r\n");
      out.write("    \t$(\"#tab\").datagrid({\r\n");
      out.write("    \t\tfit:true,\r\n");
      out.write("\t\t\turl:url,\r\n");
      out.write("    \t\tfrozenColumns:frozenColumnsTab,\r\n");
      out.write("    \t\tcolumns:columnsTabHead,\r\n");
      out.write("    \t\tcheckbox:true,\r\n");
      out.write("    \t\trownumbers:true,\r\n");
      out.write("    \t\tborder: false,\r\n");
      out.write("\t\t\tstriped: true,\r\n");
      out.write("    \t\tpagination:true,\r\n");
      out.write("    \t\tfitColumns:false,\r\n");
      out.write("    \t\ttoolbar:'#tbs',\r\n");
      out.write("    \t\tonClickCell: function (rowIndex, field, value){\r\n");
      out.write("    \t\t\tif(\"particulars\" == field){\r\n");
      out.write("    \t\t\t\tvar time = year;//时间\r\n");
      out.write("    \t\t\t\tvar coy ;//县\r\n");
      out.write("    \t\t\t\tvar data = new Array();\r\n");
      out.write("    \t\t\t\tvar rows = $(\"#tab\").datagrid(\"getRows\");//获取表格索引数据\r\n");
      out.write("    \t\t\t\tvar row = rows[rowIndex]; //根据索引获取指定行的值对象\r\n");
      out.write("    \t\t\t\tvar r = JSON.stringify(row);//转成json串\r\n");
      out.write("    \t\t\t\tvar JsonObj = eval('('+r+')');//将json串转成json对象\r\n");
      out.write("    \t\t\t\tdelete JsonObj.particulars;\r\n");
      out.write("    \t\t\t\t//遍历json对象\r\n");
      out.write("    \t\t\t\tfor(var key in JsonObj){\r\n");
      out.write("    \t\t\t\t\tif(key.indexOf(\"T\") != -1){//判断是否包含Y字母（包含代表是工程和造林类别）\r\n");
      out.write("    \t\t\t\t\t\tdata.push(key);\r\n");
      out.write("    \t\t\t\t\t}\r\n");
      out.write("    \t\t\t\t\tif(key.indexOf(\"county\") != -1){//判断是否为县key\r\n");
      out.write("    \t\t\t\t\t\tcoy = JsonObj[key];//获取县的值\r\n");
      out.write("    \t\t\t\t\t}\r\n");
      out.write("    \t\t\t\t}\r\n");
      out.write("            \t\t$(\"#opt\").window(\"open\");\r\n");
      out.write("            \t\tvar datefilename;//用来存储文件的时间+名称\r\n");
      out.write("            \t\tvar logurl = encodeURI('");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/takWorking/findLog?row='+data.join()+'&time='+time+'&county='+coy+'&zllb='+zllb);\r\n");
      out.write("            \t\t//$.ajaxSettings.async = false;\r\n");
      out.write("            \t\t/* 操作详情的表格 */\r\n");
      out.write("            \t    $(\"#optab\").datagrid({\r\n");
      out.write("            \t    \tfit:true,\r\n");
      out.write("            \t    \turl:logurl,\r\n");
      out.write("            \t    \tcolumns:[[\r\n");
      out.write("            \t    \t\t{field:'stat',title:'工作步骤',width:100,align:'center',\r\n");
      out.write("            \t    \t\t\tformatter: function(value){\r\n");
      out.write("            \t    \t\t\t\tif(value==\"1\" || value == '0'){\r\n");
      out.write("            \t    \t\t\t\t\treturn \"任务工作中\";\r\n");
      out.write("            \t    \t\t\t\t}else if(value == '2'){\r\n");
      out.write("            \t    \t\t\t\t\treturn \"造林任务完成验收\";\r\n");
      out.write("            \t    \t\t\t\t}\r\n");
      out.write("            \t    \t\t\t}},\r\n");
      out.write("            \t    \t\t{field:'name',title:'用户名',width:100,align:'center'},\r\n");
      out.write("            \t    \t\t{field:'operate',title:'执行的操作',width:80,align:'center'},\r\n");
      out.write("            \t    \t\t{field:'operateTime',title:'操作的时间',width:160,align:'center'},\r\n");
      out.write("            \t    \t\t{field:'dcode',title:'县名称',width:100,align:'center'},\r\n");
      out.write("            \t    \t\t{field:'gclb',title:'工程类别',align:'center'},\r\n");
      out.write("            \t    \t\t{field:'year',title:'工程的时间',width:100,align:'center'},\r\n");
      out.write("            \t    \t\t{field:'filename',title:'文件',align:'center'},\r\n");
      out.write("            \t    \t\t{field:'lea',title:'留言',width:200,align:'center'},\r\n");
      out.write("            \t    \t\t{field:'hi',title:'hi',width:100,align:'center',hidden:'true'},\r\n");
      out.write("            \t    \t]],\r\n");
      out.write("            \t    \tborder : false,\r\n");
      out.write("            \t\t\tstriped : true,\r\n");
      out.write("            \t    \t//显示分页栏\r\n");
      out.write("            \t    \tpagination:true,\r\n");
      out.write("            \t    \trownumbers:true,\r\n");
      out.write("            \t    \tonClickCell: function (rowIndex, field, value){\r\n");
      out.write("            \t    \t\tif(\"filename\" == field){\r\n");
      out.write("            \t    \t\t\tvar time = year;//时间\r\n");
      out.write("                \t\t\t\tvar coy ;//县\r\n");
      out.write("                \t\t\t\tvar data = new Array();\r\n");
      out.write("                \t\t\t\tvar rows = $(\"#optab\").datagrid(\"getRows\");//获取表格索引数据\r\n");
      out.write("                \t\t\t\tvar row = rows[rowIndex]; //根据索引获取指定行的值对象\r\n");
      out.write("                \t\t\t\tvar r = JSON.stringify(row);//转成json串\r\n");
      out.write("                \t\t\t\tvar JsonObj = eval('('+r+')');//将json串转成json对象\r\n");
      out.write("                \t\t\t\tvar file = JsonObj.hi;\r\n");
      out.write("                \t\t\t\t//遍历json对象\r\n");
      out.write("                \t\t\t\tvar dcurl = encodeURI(\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/takWorking/deriveFile?file=\"+file);\r\n");
      out.write("            \t    \t\t\twindow.location.href=dcurl;\r\n");
      out.write("            \t    \t\t}\r\n");
      out.write("            \t    \t}\r\n");
      out.write("            \t    });\r\n");
      out.write("    \t\t\t}\r\n");
      out.write("    \t\t\t\r\n");
      out.write("        \t}\r\n");
      out.write("    \t});\r\n");
      out.write("    \t//获取当前浏览器的类型\r\n");
      out.write("    \tvar userAgent = navigator.userAgent;\r\n");
      out.write("    \t\r\n");
      out.write("    \tif(userAgent.indexOf(\"Firefox\") > -1){//判断是否是火狐\r\n");
      out.write("    \t\t//$(\"#tet\").css(\"width\",\"335px\");\r\n");
      out.write("    \t$(\"#upt\").css(\"height\",\"400px\");\r\n");
      out.write("    \t$(\"#tet\").css(\"width\",\"650px\");\r\n");
      out.write("    \t}\r\n");
      out.write("    \t\r\n");
      out.write("    \tif(userAgent.indexOf(\"Trident\") > -1){\r\n");
      out.write("    \t\t$(\"#upt\").css(\"height\",\"400px\");\r\n");
      out.write("        \t$(\"#tet\").css(\"width\",\"650px\");\r\n");
      out.write("    \t}\r\n");
      out.write("    \tif(userAgent.indexOf(\"QQBrowser\")){//QQBrowser\r\n");
      out.write("    \t\tconsole.info(userAgent.indexOf(\"QQBrowser\"));\r\n");
      out.write("    \t}\r\n");
      out.write("    }\r\n");
      out.write("    \r\n");
      out.write("    \r\n");
      out.write("    $(\"#year\").numberspinner({\r\n");
      out.write("    \t\"onChange\":function(){\r\n");
      out.write("    \t\tvar node =$(\"#tree\").tree('getSelected');\r\n");
      out.write("   \t\t\tinit();//获取数据表格表头数据\r\n");
      out.write("   \t\t\tinTable();//初始化数据表格\r\n");
      out.write("    \t}\r\n");
      out.write("    });\r\n");
      out.write("    \r\n");
      out.write("    \tfunction click(node){\r\n");
      out.write("    \t\t$(\"#zllb\").combobox('clear');//清楚工程列表\r\n");
      out.write("    \t\tinit();//加载表头\r\n");
      out.write("\t\t\tinTable();//初始化表格\r\n");
      out.write("    \t}\r\n");
      out.write("    \t//保存\r\n");
      out.write("       \tfunction save(){\r\n");
      out.write("       \t\t//获取文本框内容\r\n");
      out.write("       \t\tlea = $(\"#tet\").val();\r\n");
      out.write("       \t\t$(\"#upt\").window(\"close\");\r\n");
      out.write("       \t\tsh1=true;\r\n");
      out.write("        \tsh2=false;\r\n");
      out.write("       \t\tback();\r\n");
      out.write("       \t\t$(\"#spaninfo\").html(\"\");\r\n");
      out.write("        \t$(\"#tet\").val(null);\r\n");
      out.write("       \t}\r\n");
      out.write("        \r\n");
      out.write("    \t//删除文件\r\n");
      out.write("        function delFile(){\r\n");
      out.write("        \t$.ajax({\r\n");
      out.write("    \t\t\t\tasync:false,\r\n");
      out.write("    \t\t\t\turl:'");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/takWorking/delFile',\r\n");
      out.write("    \t\t\t\tdataType:'json',\r\n");
      out.write("    \t\t\t\tdata:{\"msg\":msg},\r\n");
      out.write("    \t\t\t\tsuccess:function(data){\r\n");
      out.write("    \t\t\t\t\tvar d = data.data;\r\n");
      out.write("    \t\t\t\t},\r\n");
      out.write("    \t\t\t\t\r\n");
      out.write("    \t\t\t});\r\n");
      out.write("        }\r\n");
      out.write("        function cancel(){\r\n");
      out.write("        \t$(\"#upt\").window(\"close\");\r\n");
      out.write("        \t$(\"#spaninfo\").html(\"\");\r\n");
      out.write("        \t$(\"#tet\").val(null);\r\n");
      out.write("        \t$(\"#tbody\").html(\"\");\r\n");
      out.write("        \tdelFile();\r\n");
      out.write("        }\r\n");
      out.write("        \r\n");
      out.write("        //删除指定行\r\n");
      out.write("        function delFileName(obj){\r\n");
      out.write("        \tmsg = obj.id;\r\n");
      out.write("        \t//删除数组中的文件\r\n");
      out.write("        \tfor(var i=0;i<=bdgwj.length;i++){\r\n");
      out.write("        \t\tif(msg == bdgwj[i]){\r\n");
      out.write("        \t\t\tvar f = bdgwj.splice(i);\r\n");
      out.write("        \t\t\tconsole.info(f);\r\n");
      out.write("        \t\t}\r\n");
      out.write("        \t}\r\n");
      out.write("        \t\r\n");
      out.write("        \tdelFile();\r\n");
      out.write("        \t\r\n");
      out.write("        \t$(obj).parents(\"tr\").remove();\r\n");
      out.write("        }\r\n");
      out.write("    </script>\r\n");
      out.write("<!-- 详情弹出窗口 -->\r\n");
      out.write("    <div id=\"opt\" class=\"easyui-window\" title=\"操作详情\" style=\"width:1052px;height:400px;\" data-options=\"maximizable:false,minimizable:false,iconCls:'icon-save',modal:true,closed:true\"> \r\n");
      out.write("\t\t\r\n");
      out.write("\t\t<table id=\"optab\"  ></table>\r\n");
      out.write("\r\n");
      out.write("\t</div>\r\n");
      out.write("\r\n");
      out.write("    <!-- 上传窗口 -->\r\n");
      out.write("    <div id=\"upt\" class=\"easyui-window\" title=\"上传窗口\" style=\"width:850px;height:450px;\" data-options=\"maximizable:false,minimizable:false,iconCls:'icon-save',modal:true,closed:true,closable:false,resizable:false\"> \r\n");
      out.write("\t\t<p style=\"margin-top: 20px;margin-left: 45px;position: absolute;\">情况说明:</p>\r\n");
      out.write("\t\t<textarea rows=\"7\" cols=\"100\" id=\"tet\" style=\"margin-top: 20px;margin-left: 100px\" ></textarea><br><br>\r\n");
      out.write("\t\t<!-- <a href=\"javascript:;\" class=\"file\">选择文件 -->\r\n");
      out.write("\t\t<a href=\"javascript:;\" class=\"a-upload\" style=\"margin-left: 100px;margin-top: 10px\"><!-- //style=\"margin-left: 100px; -->\r\n");
      out.write("\t\t<input id=\"fileupload\" type=\"file\" name=\"fileName\" data-url=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/taskWorking/upFile\" >点击这里上传文件\r\n");
      out.write("\t\t</a><span id=\"spaninfo\"></span>\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t<br>\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t<table style=\"margin-left: 100px;\" border=\"1\" bordercolor=\t#FFFFFF cellspacing=\"0\" cellpadding=\"0\">\r\n");
      out.write("\t\t\t<thead >\r\n");
      out.write("\t\t\t\t<tr>\r\n");
      out.write("\t\t\t\t\t<th width=\"351px\" align=\"center\" style='border-color:gray'><font color=\"gray\">文件名</font></th>\r\n");
      out.write("\t\t\t\t\t<th width=\"300px\" align=\"center\" style='border-color:gray'><font color=\"gray\">操作</font></th>\r\n");
      out.write("\t\t\t\t\t<th width=\"100px\" align=\"center\" style=\"display: none\">id</th>\r\n");
      out.write("\t\t\t\t</tr>\r\n");
      out.write("\t\t\t</thead>\r\n");
      out.write("\t\t\t<tbody id=\"tbody\">\r\n");
      out.write("\t\t\t</tbody>\r\n");
      out.write("\t\t</table>\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t<input style=\"margin-top: 50px;margin-left: 340px;\" type=\"button\" value=\"确定\" onclick=\"save()\" class=\"bcbtn\">\r\n");
      out.write("\t\t<input style=\"margin-left: 70px\" type=\"button\" value=\"取消\" onclick=\"cancel()\" class=\"qxbtn\">\r\n");
      out.write("\t</div>\r\n");
      out.write("</body>\r\n");
      out.write("</html>\r\n");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try { out.clearBuffer(); } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }

  private boolean _jspx_meth_shiro_005fhasPermission_005f0(javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  shiro:hasPermission
    org.apache.shiro.web.tags.HasPermissionTag _jspx_th_shiro_005fhasPermission_005f0 = (org.apache.shiro.web.tags.HasPermissionTag) _005fjspx_005ftagPool_005fshiro_005fhasPermission_0026_005fname.get(org.apache.shiro.web.tags.HasPermissionTag.class);
    _jspx_th_shiro_005fhasPermission_005f0.setPageContext(_jspx_page_context);
    _jspx_th_shiro_005fhasPermission_005f0.setParent(null);
    // /taskFinished.jsp(128,8) name = name type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
    _jspx_th_shiro_005fhasPermission_005f0.setName("sys:rwwc:th");
    int _jspx_eval_shiro_005fhasPermission_005f0 = _jspx_th_shiro_005fhasPermission_005f0.doStartTag();
    if (_jspx_eval_shiro_005fhasPermission_005f0 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
      do {
        out.write("\r\n");
        out.write("       \t<a href=\"javascript:void(0)\" class=\"easyui-linkbutton\" data-options=\"iconCls:'icon-back',plain:true\" onclick=\"back()\">退回</a>\r\n");
        out.write("       \t");
        int evalDoAfterBody = _jspx_th_shiro_005fhasPermission_005f0.doAfterBody();
        if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
          break;
      } while (true);
    }
    if (_jspx_th_shiro_005fhasPermission_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
      _005fjspx_005ftagPool_005fshiro_005fhasPermission_0026_005fname.reuse(_jspx_th_shiro_005fhasPermission_005f0);
      return true;
    }
    _005fjspx_005ftagPool_005fshiro_005fhasPermission_0026_005fname.reuse(_jspx_th_shiro_005fhasPermission_005f0);
    return false;
  }
}
